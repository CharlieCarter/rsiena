<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Function to estimate parameters in a Siena model — siena07 • RSiena</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Function to estimate parameters in a Siena model — siena07" />
<meta property="og:description" content="Estimates parameters in a Siena model using method of moments, based on direct
 simulation, conditional or otherwise; or using Maximum Likelihood by MCMC
 simulation. Estimation is done using a Robbins-Monro algorithm. Note that
 the data and particular model to be used
 must be passed in using named arguments as the ...,
 and the specification for the algorithm must be passed on as x, which is
 a sienaAlgorithm object as produced by
 sienaAlgorithmCreate (see examples)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RSiena</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2-25</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">In the package</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/snlab-nl/rsiena">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to estimate parameters in a Siena model</h1>
    
    <div class="hidden name"><code>siena07.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimates parameters in a Siena model using method of moments, based on direct
 simulation, conditional or otherwise; or using Maximum Likelihood by MCMC
 simulation. Estimation is done using a Robbins-Monro algorithm. Note that
 the data and particular model to be used
 must be passed in using named arguments as the <code>...</code>,
 and the specification for the algorithm must be passed on as <code>x</code>, which is
 a <code><a href='sienaAlgorithmCreate.html'>sienaAlgorithm</a></code> object as produced by
 <code><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></code> (see examples).</p>
    </div>

    <pre class="usage"><span class='fu'>siena07</span>(<span class='no'>x</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>silent</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
        <span class='kw'>useCluster</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>nbrNodes</span><span class='kw'>=</span><span class='fl'>2</span>,
        <span class='kw'>thetaValues</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
        <span class='kw'>initC</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
        <span class='kw'>clusterString</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"localhost"</span>, <span class='no'>nbrNodes</span>), <span class='kw'>tt</span><span class='kw'>=</span><span class='kw'>NULL</span>,
        <span class='kw'>parallelTesting</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>clusterIter</span><span class='kw'>=</span>!<span class='no'>x</span>$<span class='no'>maxlike</span>,
        <span class='kw'>clusterType</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"PSOCK"</span>, <span class='st'>"FORK"</span>), <span class='kw'>cl</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A control object, of class <code><a href='sienaAlgorithmCreate.html'>sienaAlgorithm</a>. </code></p></td>
    </tr>
    <tr>
      <th>batch</th>
      <td><p>Desired interface: FALSE gives a gui (graphical user interface
     implemented as a tcl/tk screen),
     TRUE gives a small (if <code>verbose=FALSE</code>) amount of printout
     to the console.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Produces various output to the console if TRUE.</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>Produces no output to the console if TRUE, even if batch mode.</p></td>
    </tr>
    <tr>
      <th>useCluster</th>
      <td><p>Boolean: whether to use a cluster of processes (useful if
  multiple processors are available).</p></td>
    </tr>
    <tr>
      <th>nbrNodes</th>
      <td><p>Number of processes to use if useCluster is TRUE.</p></td>
    </tr>
    <tr>
      <th>thetaValues</th>
      <td><p>If not <code>NULL</code>, this should be a matrix with parameter
    values to be used in Phase 3. The number of columns must be equal to the
    number of estimated parameters in the effects object (if conditional estimation
    is used, without the rate parameters for the conditioning
    dependent variable). Can only be used if <code>x$simOnly=TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>initC</th>
      <td><p>Boolean: set to TRUE if the simulation will use C
   routines (currently always needed). Only for use if using
   multiple processors, to ensure all copies are initialised
   correctly. Ignored otherwise, so is set to TRUE by default.</p></td>
    </tr>
    <tr>
      <th>clusterString</th>
      <td><p>Definitions of clusters. Default set up to use
   the local machine only.</p></td>
    </tr>
    <tr>
      <th>tt</th>
      <td><p>A <code>tcltk</code> toplevel window. Used if called from the
   model options screen.</p></td>
    </tr>
    <tr>
      <th>parallelTesting</th>
      <td><p>Boolean. If TRUE, sets up random numbers to
   parallel those in Siena 3.</p></td>
    </tr>
    <tr>
      <th>clusterIter</th>
      <td><p>Boolean. If TRUE, multiple processes execute
   complete iterations at each call.
   If FALSE, multiple processes execute a single wave at each call.</p></td>
    </tr>
    <tr>
      <th>clusterType</th>
      <td><p>Either "PSOCK" or "FORK". On Windows, must be
  "PSOCK". On a single non-Windows machine may be "FORK", and
  subprocesses will be formed by forking. If "PSOCK", subprocesses are
  formed using <span style="R">R</span> scripts.</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p>An object of class c("SOCKcluster", "cluster") (see Details).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments for the simulation function, see
    <code><a href='simstats0c.html'>simstats0c</a></code>:
    in any case, <code>data</code> and <code>effects</code>, as in the examples below;<br />
    possibly also <code>prevAns</code> if a previous reasonable
    provisional estimate was obtained for a similar model;<br />
    possibly also <code>returnDeps</code> if the simulated dependent variables
    (networks, behaviour) should be returned;<br />
    possibly also <code>returnChains</code> if the simulated sequences (chains)
    of ministeps should be returned; this may produce a very big file.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is the main function and workhorse of RSienaTest.</p>
<p>For use of <code>siena07</code>, it is necessary to specify parameters <code>data</code>
  (RSiena data set) and <code>effects</code> (effects object), which are
  required parameters in function <code><a href='simstats0c.html'>simstats0c</a></code>.
  (These parameters are inserted through '...'.) See the examples.</p>
<p><code>siena07</code> runs a Robbins-Monro algorithm for parameter estimation
 according to the Method of Moments using the three-phase
 implementation in Snijders (2001) and
 Snijders, Steglich and Schweinberger (2007),
 with (if <code>x$findiff=FALSE</code>)
 derivative estimation as in Schweinberger and Snijders (2007).
 Phase 1 does a few iterations to
 estimate the derivative matrix of the targets with respect to the
 parameter vector. Phase 2 does the estimation. Phase 3 runs a
 simulation to estimate standard errors and check convergence of the model. The
 simulation function is called once for each iteration in these phases
 and also once to initialise the model fitting and once to complete it.
 Unless in batch mode, a tcl/tk screen is displayed to allow interruption
 and to show progress.</p>
<p>If  <code>x$maxlike=TRUE</code>, estimation is done by Maximum Likelihood
 implemented as in Snijders, Koskinen and Schweinberger (2010); also using
 the three-phase Robbins-Monro algorithm.</p>
<p>It is necessary to check that convergence has been achieved.
 The rule of thumb is that the all t-ratios for convergence should be
 in absolute value less than 0.1 and
 the overall maximum convergence ratio should be less than 0.25.
 If this was not achieved, the result can be used to start
 another estimation run from the estimate obtained, using
 the parameter <code>prevAns</code> as illustrated in the example below.
 (This parameter is inserted through '...' into the function
 <code><a href='simstats0c.html'>initializeFRAN</a></code>.)</p>
<p>For good estimation of standard errors, it is necessary that <code>x$n3</code> is
 large enough. More about this is in the manual. The default value <code>x$n3</code>
 set in <code><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></code> is adequate for most explorative use,
 but for presentation in publications larger values are necessary, depending
 on the data set and model; e.g., <code>x$n3=3000</code> or larger.</p>
<p>Parameters can be tested against zero by dividing the estimate by its
 standard error and using an approximate standard normal null distribution.
 Further, functions <code><a href='Wald.html'>Wald.RSiena</a></code> and
 <code><a href='Wald.html'>Multipar.RSiena</a></code> are available for multi-parameter testing.<br />
 Parameters specified in <code><a href='includeEffects.html'>includeEffects</a></code> or
 <code><a href='setEffect.html'>setEffect</a></code> with <code>fix=TRUE, test=TRUE</code> will not be estimated;
 score tests of their hypothesized values are reported in the output file
 specified in the control (algorithm) object.
 These tests can be obtained also using <code><a href='Wald.html'>score.Test</a></code>.</p>
<p>If <code>x$simOnly</code> is <code>TRUE</code>, which is meant to go together with
 <code>x$nsub=0</code>, the calculation of the standard errors and covariance
 matrix at the end of Pase 3 is skipped. No estimation is performed.
 If <code>thetaValues</code> is not <code>NULL</code>, the parameter values in
 the rows of this matrix will be used in the consecutive runs of Phase 3.
 If <code>x$n3</code> is larger than the number of rows times <code>nbrNodes</code>
 (see below), the last row of <code>thetaValues</code> will continue to be used.
 The parameter values actually used will be stored in the
 output matrix <code>thetaUsed</code>.</p>
<p>In the case of using multiple processors, there are two options for telling
 <code>siena07</code> to use them. By specifying the options <code>useCluster</code>, <code>nbrNodes</code>,
 <code>clusterString</code> and <code>initC</code>, <code>siena07</code> will create a
 <code>cluster object</code> that will be used by the
 <code>parallel</code> package. After finishing the estimation procedure,
 <code>siena07</code> will automatically stop the cluster. Alternatively, instead of
 having the function to create a cluster, the user may provide its own by
 specifying the option <code>cl</code>, similar to what the boot function does in
 the <a href='https://CRAN.R-project.org/package=boot'><span class="pkg">boot</span></a> package. By using the option <code>cl</code> the user may be
 able to create more complex clusters (see examples below).</p>
<p>If <code>thetaValues</code> is not <code>NULL</code> and <code>nbrNodes &gt;= 2</code>, parameters
 in Phase 3 will be constant for each set of <code>nbrNodes</code> consecutive
 simulations. This must be noted in the interpretation, and will be visible
 in <code>thetaUsed</code> (see below).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an object of class <code><a href='sienaFit.html'>sienaFit</a></code>, some parts of which are:</p>
<dt>OK</dt><dd><p>Boolean indicating successful termination</p></dd>
  <dt>termination </dt><dd><p>Character string, values: "OK", "Error", or
    "UserInterrupt". "UserInterrupt" indicates that the user asked for early
  termination before phase 3.</p></dd>
  <dt>f</dt><dd><p>Various characteristics of the data and model definition.</p></dd>
  <dt>requestedEffects</dt><dd><p>The included effects in the effects object.</p></dd>
  <dt>effects</dt><dd><p>The included effects in the effects object to which are added
    the main effects of the requested interaction effects, if any.</p></dd>
  <dt>theta</dt><dd><p>Estimated value of theta, if <code>x$simOnly=FALSE</code>.</p></dd>
  <dt>covtheta</dt><dd><p>Estimated covariance matrix of theta; this is not available
    if <code>x$simOnly=TRUE</code>.</p></dd>
  <dt>se</dt><dd><p>Vector of standard errors of estimated theta, if <code>x$simOnly=FALSE</code>.</p></dd>
  <dt>dfra</dt><dd><p>Matrix of estimated derivatives.</p></dd>
  <dt>sf</dt><dd><p>Matrix of simulated deviations from targets in phase 3.</p></dd>
  <dt>sf2</dt><dd><p>Array of periodwise deviations from simulations in phase 3.
    Not included if <code>lessMem=FALSE</code> in <code><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></code>.</p></dd>
  <dt>tconv</dt><dd><p>t-statistics for convergence.</p></dd>
  <dt>tmax</dt><dd><p>maximum absolute t-statistic for convergence for non-fixed parameters.</p></dd>
  <dt>tconv.max</dt><dd><p>overall maximum convergence ratio.</p></dd>
  <dt>targets</dt><dd><p>Observed statistics; for ML, zero vector.</p></dd>
  <dt>targets2</dt><dd><p>Observed statistics by wave,
    starting with second wave; for ML, zero matrix.</p></dd>
  <dt>ssc</dt><dd><p>Score function contributions for each wave for each
    simulation in phase 3. Not included if finite difference method is used
    or if <code>x$lessMem=FALSE</code>.</p></dd>
  <dt>scores</dt><dd><p>Score functions, added over waves, for each
    simulation in phase 3. Only included
    if <code>x$lessMem=FALSE</code>.</p></dd>
  <dt>regrCoef</dt><dd><p>If <code>x$dolby</code> and not <code>x$maxlike</code>:
    regression coefficients of estimation statistics on score functions.</p></dd>
  <dt>regrCor</dt><dd><p>If <code>x$dolby</code> and not <code>x$maxlike</code>:
    correlations between estimation statistics and score functions.</p></dd>
  <dt>estMeans</dt><dd><p>Estimated means of estimation statistics.</p></dd>
  <dt>estMeans.sem</dt><dd><p>If <code>x$simOnly</code>: Standard errors of the
    estimated means of estimation statistics.</p></dd>
 <dt>sims</dt><dd><p>If <code>returnDeps=TRUE</code>:
    list of simulated dependent variables (networks, behaviour).
    Networks are given as a list of edgelists, one for each period.<br />
    The structure of sims is a nested list:
    <code>sims[[run]][[group]][[dependent variable]][[period]]</code>.
    If <code>x$maxlike=TRUE</code> and there is only one group and one period,
    the structure is <code>[[run]][[dependent variable]]</code>.</p></dd>
 <dt>chain</dt><dd><p>If <code>returnChains = TRUE</code>:
    list, or data frame, of simulated chains of ministeps.
    The chain has the structure
    <code>chain[[run]][[depvar]][[period]][[ministep]]</code>.</p></dd>
   <dt>Phase3nits</dt><dd><p>Number of iterations actually performed in phase 3.</p></dd>
   <dt>thetaUsed</dt><dd><p>If <code>thetaValues</code> is not <code>NULL</code>, the matrix
   of parameter values actually used in the simulations of Phase 3.</p></dd>
  Writes text output to the file named "projname.txt", where projname is defined
  in the <a href='sienaAlgorithmCreate.html'>sienaAlgorithm</a> object x.

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <ul>
<li><p>Schweinberger, Michael, and Snijders,
    Tom A.B. (2007). Markov models for digraph panel data:
    Monte Carlo-based derivative estimation.
    <em>Computational Statistics and Data Analysis</em> <b>51</b>, 4465--4483.</p></li>
<li><p>Snijders, Tom A.B. (2001).
    The statistical evaluation of social network dynamics.
    <em>Sociological Methodology</em> 31, 361-395.</p></li>
<li><p>Snijders, Tom A.B. (2017). Stochastic Actor-Oriented Models for Network
   Dynamics. <em>Annual Review of Statistics and Its Application</em> <b>4</b>, 343--363.</p></li>
<li><p>Snijders, Tom A. B., Koskinen, Johan, and Schweinberger, Michael (2010).
    Maximum likelihood estimation for social network dynamics.
    <em>Annals of Applied Statistics</em> <b>4</b>, 567--588.</p></li>
<li><p>Snijders, Tom A.B., Steglich, Christian E.G., and Schweinberger,
    Michael (2007). Modeling the co-evolution of networks and behavior.
    Pp. 41--71 in <em>Longitudinal models in the behavioral
    and related sciences</em>,
    edited by Kees van Montfort, Han Oud and Albert Satorra; Lawrence Erlbaum.</p></li>
<li><p>Steglich, Christian E. G., Snijders, Tom A. B., and
    Pearson, Michael A. (2010). Dynamic networks and behavior:
    Separating selection from influence. 
    <em>Sociological Methodology</em> <b>40</b>, 329--393.</p></li>
<li><p>Information about the implementation of the algorithm is in
     <a href='http://www.stats.ox.ac.uk/~snijders/siena/Siena_algorithms.pdf'>http://www.stats.ox.ac.uk/~snijders/siena/Siena_algorithms.pdf</a>.</p></li>
<li><p>Further see <a href='http://www.stats.ox.ac.uk/~snijders/siena/'>http://www.stats.ox.ac.uk/~snijders/siena/</a> .</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sienaDataCreate.html'>siena</a></code>, <code><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></code>,
  <code><a href='getEffects.html'>sienaEffects</a></code>,
  <code><a href='Wald.html'>Wald.RSiena</a></code>, <code><a href='Wald.html'>Multipar.RSiena</a></code>,
  <code><a href='Wald.html'>score.Test</a></code>.</p>
<p>There are print, summary and xtable methods for <code><a href='sienaFit.html'>sienaFit</a></code>
  objects: <code><a href='xtable.html'>xtable</a></code>, <code><a href='sienaFit.html'>print.sienaFit</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>myalgorithm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></span>(<span class='kw'>nsub</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>n3</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>1293</span>)</div><div class='output co'>#&gt; If you use this algorithm object, siena07 will create an output file Siena.txt .</div><div class='input'><span class='co'># nsub=2 and n3=100 is used here for having a brief computation, not for practice.</span>
<span class='no'>mynet1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>tmp3</span>, <span class='no'>tmp4</span>), <span class='kw'>dim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>32</span>, <span class='fl'>32</span>, <span class='fl'>2</span>)))
<span class='no'>mydata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDataCreate.html'>sienaDataCreate</a></span>(<span class='no'>mynet1</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getEffects.html'>getEffects</a></span>(<span class='no'>mydata</span>)
<span class='no'>ans</span> <span class='kw'>&lt;-</span> <span class='fu'>siena07</span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; 
#&gt; Start phase 0 
#&gt; theta: -0.56  0.00 
#&gt; 
#&gt; Start phase 1 
#&gt; Phase 1 Iteration 1 Progress: 0%
#&gt; Phase 1 Iteration 2 Progress: 0%
#&gt; Phase 1 Iteration 3 Progress: 0%
#&gt; Phase 1 Iteration 4 Progress: 1%
#&gt; Phase 1 Iteration 5 Progress: 1%
#&gt; Phase 1 Iteration 10 Progress: 1%
#&gt; Phase 1 Iteration 15 Progress: 2%
#&gt; Phase 1 Iteration 20 Progress: 3%
#&gt; Phase 1 Iteration 25 Progress: 3%
#&gt; Phase 1 Iteration 30 Progress: 4%
#&gt; Phase 1 Iteration 35 Progress: 5%
#&gt; Phase 1 Iteration 40 Progress: 6%
#&gt; Phase 1 Iteration 45 Progress: 6%
#&gt; Phase 1 Iteration 50 Progress: 7%
#&gt; theta: -0.622  0.311 
#&gt; 
#&gt; Start phase 2.1
#&gt; Phase 2 Subphase 1 Iteration 1 Progress: 21%
#&gt; Phase 2 Subphase 1 Iteration 2 Progress: 21%
#&gt; theta -0.699  0.762 
#&gt; ac 0.143 2.034 
#&gt; Phase 2 Subphase 1 Iteration 3 Progress: 21%
#&gt; Phase 2 Subphase 1 Iteration 4 Progress: 21%
#&gt; theta -0.963  1.700 
#&gt; ac 0.234 1.979 
#&gt; Phase 2 Subphase 1 Iteration 5 Progress: 21%
#&gt; Phase 2 Subphase 1 Iteration 6 Progress: 21%
#&gt; theta -1.14  2.02 
#&gt; ac 0.219 1.979 
#&gt; Phase 2 Subphase 1 Iteration 7 Progress: 22%
#&gt; Phase 2 Subphase 1 Iteration 8 Progress: 22%
#&gt; theta -1.22  1.99 
#&gt; ac 0.223 1.968 
#&gt; Phase 2 Subphase 1 Iteration 9 Progress: 22%
#&gt; Phase 2 Subphase 1 Iteration 10 Progress: 22%
#&gt; theta -1.24  1.97 
#&gt; ac 0.267 0.740 
#&gt; theta -1.15  1.78 
#&gt; ac -0.00224 -0.21418 
#&gt; theta: -1.15  1.78 
#&gt; 
#&gt; Start phase 2.2
#&gt; Phase 2 Subphase 2 Iteration 1 Progress: 51%
#&gt; Phase 2 Subphase 2 Iteration 2 Progress: 51%
#&gt; Phase 2 Subphase 2 Iteration 3 Progress: 52%
#&gt; Phase 2 Subphase 2 Iteration 4 Progress: 52%
#&gt; Phase 2 Subphase 2 Iteration 5 Progress: 52%
#&gt; Phase 2 Subphase 2 Iteration 6 Progress: 52%
#&gt; Phase 2 Subphase 2 Iteration 7 Progress: 52%
#&gt; Phase 2 Subphase 2 Iteration 8 Progress: 52%
#&gt; Phase 2 Subphase 2 Iteration 9 Progress: 52%
#&gt; Phase 2 Subphase 2 Iteration 10 Progress: 53%
#&gt; theta -1.13  1.79 
#&gt; ac -0.13555 -0.00968 
#&gt; theta: -1.13  1.79 
#&gt; 
#&gt; Start phase 3 </div><div class='input'>
<span class='co'># or for non-conditional estimation --------------------------------------------</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></span>(<span class='kw'>nsub</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>n3</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>cond</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>1283</span>)
<span class='no'>ans</span> <span class='kw'>&lt;-</span> <span class='fu'>siena07</span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
        }

<span class='co'># or if a previous "on track" result ans was obtained --------------------------</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>ans1</span> <span class='kw'>&lt;-</span> <span class='fu'>siena07</span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>prevAns</span><span class='kw'>=</span><span class='no'>ans</span>)
         }

<span class='co'># Running in multiple processors -----------------------------------------------</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Not tested because dependent on presence of processors</span>
<span class='co'># Find out how many processors there are</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>parallel</span>)
(<span class='no'>n.clus</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span>() - <span class='fl'>1</span>)
<span class='co'># number of cores; 1 is subtracted to keep time for other processes</span>
<span class='no'>ans2</span> <span class='kw'>&lt;-</span> <span class='fu'>siena07</span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
                <span class='kw'>useCluster</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>nbrNodes</span><span class='kw'>=</span><span class='no'>n.clus</span>, <span class='kw'>initC</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='co'># Suppose 8 processors are going to be used.</span>
<span class='co'># Loading the parallel package and creating a cluster</span>
<span class='co'># with 8 processors (this should be equivalent)</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>parallel</span>)
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span>(<span class='no'>n.clus</span>)

<span class='no'>ans3</span> <span class='kw'>&lt;-</span> <span class='fu'>siena07</span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='no'>cl</span>)

<span class='co'># Notice that now -siena07- perhaps won't stop the cluster for you.</span>
<span class='co'># stopCluster(cl)</span>

<span class='co'># You can create even more complex clusters using several computers. In this</span>
<span class='co'># example we are creating a cluster with 3*8 = 24 processors on three</span>
<span class='co'># different machines.</span>
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makePSOCKcluster</a></span>(
    <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'localhost'</span>, <span class='st'>'machine2.website.com'</span> , <span class='st'>'machine3.website.com'</span>), <span class='fl'>8</span>),
    <span class='kw'>user</span><span class='kw'>=</span><span class='st'>'myusername'</span>, <span class='kw'>rshcmd</span><span class='kw'>=</span><span class='st'>'ssh -p PORTNUMBER'</span>)

<span class='no'>ans4</span> <span class='kw'>&lt;-</span> <span class='fu'>siena07</span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='no'>cl</span>)
<span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span>(<span class='no'>cl</span>)
}
<span class='co'># Accessing simulated networks for ML ------------------------------------------</span>
<span class='co'># The following is an example for accessing the simulated networks for ML,</span>
<span class='co'># which makes sense only if there are some missing tie variables;</span>
<span class='co'># observed tie variables are identically simulated</span>
<span class='co'># at the moment of observation,</span>
<span class='co'># missing tie variable are imputed in a model-based way.</span>
<span class='no'>mat1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,
                 <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,
                 <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,
                 <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>),<span class='fl'>4</span>,<span class='fl'>4</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>mat2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,
                 <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,
                 <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,
                 <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),<span class='fl'>4</span>,<span class='fl'>4</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>mat3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,
                 <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,
                 <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,
                 <span class='fl'>NA</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>),<span class='fl'>4</span>,<span class='fl'>4</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>mats</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>mat1</span>,<span class='no'>mat2</span>,<span class='no'>mat3</span>), <span class='kw'>dim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>3</span>))
<span class='no'>net</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='no'>mats</span>, <span class='kw'>allowOnly</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='no'>sdat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDataCreate.html'>sienaDataCreate</a></span>(<span class='no'>net</span>)
<span class='no'>alg</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></span>(<span class='kw'>maxlike</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>nsub</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>n3</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>12534</span>)</div><div class='output co'>#&gt; If you use this algorithm object, siena07 will create an output file Siena.txt .</div><div class='input'><span class='no'>effs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getEffects.html'>getEffects</a></span>(<span class='no'>sdat</span>)
(<span class='no'>ans</span> <span class='kw'>&lt;-</span> <span class='fu'>siena07</span>(<span class='no'>alg</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>sdat</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>effs</span>, <span class='kw'>returnDeps</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>))</div><div class='output co'>#&gt; 
#&gt; Start phase 0 
#&gt; theta:  1.9077  2.0667 -0.0408  0.0000 
#&gt; 
#&gt; Start phase 1 
#&gt; Phase 1 Iteration 1 Progress: 0%
#&gt; Phase 1 Iteration 2 Progress: 0%
#&gt; Phase 1 Iteration 3 Progress: 0%
#&gt; Phase 1 Iteration 4 Progress: 0%
#&gt; Phase 1 Iteration 5 Progress: 0%
#&gt; Phase 1 Iteration 6 Progress: 1%
#&gt; Phase 1 Iteration 7 Progress: 1%
#&gt; Phase 1 Iteration 8 Progress: 1%
#&gt; Phase 1 Iteration 9 Progress: 1%
#&gt; Phase 1 Iteration 10 Progress: 1%
#&gt; Phase 1 Iteration 11 Progress: 1%
#&gt; Phase 1 Iteration 12 Progress: 1%
#&gt; Phase 1 Iteration 13 Progress: 1%
#&gt; Phase 1 Iteration 14 Progress: 1%
#&gt; Phase 1 Iteration 15 Progress: 1%
#&gt; Phase 1 Iteration 16 Progress: 2%
#&gt; Phase 1 Iteration 17 Progress: 2%
#&gt; Phase 1 Iteration 18 Progress: 2%
#&gt; Phase 1 Iteration 19 Progress: 2%
#&gt; theta:  1.9077  2.0667 -0.0355  0.0258 
#&gt; 
#&gt; Start phase 2.1
#&gt; Phase 2 Subphase 1 Iteration 1 Progress: 9%
#&gt; Phase 2 Subphase 1 Iteration 2 Progress: 9%
#&gt; theta  1.908  2.067 -0.126  0.132 
#&gt; ac -2.000 -2.000 -0.742  0.122 
#&gt; Phase 2 Subphase 1 Iteration 3 Progress: 9%
#&gt; Phase 2 Subphase 1 Iteration 4 Progress: 9%
#&gt; theta  1.908  2.067 -0.282  0.557 
#&gt; ac -2.000 -2.000 -0.775 -0.302 
#&gt; Phase 2 Subphase 1 Iteration 5 Progress: 9%
#&gt; Phase 2 Subphase 1 Iteration 6 Progress: 10%
#&gt; theta  1.908  2.067 -0.285  0.614 
#&gt; ac -2.000 -2.000 -0.335 -0.307 
#&gt; Phase 2 Subphase 1 Iteration 7 Progress: 10%
#&gt; Phase 2 Subphase 1 Iteration 8 Progress: 10%
#&gt; theta  1.908  2.067 -0.263  0.726 
#&gt; ac -2.000 -2.000 -0.402 -0.488 
#&gt; Phase 2 Subphase 1 Iteration 9 Progress: 10%
#&gt; Phase 2 Subphase 1 Iteration 10 Progress: 10%
#&gt; theta  1.908  2.067 -0.232  0.729 
#&gt; ac -2.000 -2.000 -0.470 -0.468 
#&gt; theta  1.908  2.067 -0.316  0.628 
#&gt; ac -2.000 -2.000  0.179  0.229 
#&gt; theta:  1.908  2.067 -0.316  0.628 
#&gt; 
#&gt; Start phase 2.2
#&gt; Phase 2 Subphase 2 Iteration 1 Progress: 30%
#&gt; Phase 2 Subphase 2 Iteration 2 Progress: 31%
#&gt; Phase 2 Subphase 2 Iteration 3 Progress: 31%
#&gt; Phase 2 Subphase 2 Iteration 4 Progress: 31%
#&gt; Phase 2 Subphase 2 Iteration 5 Progress: 31%
#&gt; Phase 2 Subphase 2 Iteration 6 Progress: 31%
#&gt; Phase 2 Subphase 2 Iteration 7 Progress: 31%
#&gt; Phase 2 Subphase 2 Iteration 8 Progress: 31%
#&gt; Phase 2 Subphase 2 Iteration 9 Progress: 31%
#&gt; Phase 2 Subphase 2 Iteration 10 Progress: 31%
#&gt; theta  1.908  2.067 -0.369  0.810 
#&gt; ac 0.573 0.417 0.454 0.712 
#&gt; theta:  1.908  2.067 -0.369  0.810 
#&gt; 
#&gt; Start phase 2.3
#&gt; Phase 2 Subphase 3 Iteration 1 Progress: 56%
#&gt; Phase 2 Subphase 3 Iteration 2 Progress: 56%
#&gt; Phase 2 Subphase 3 Iteration 3 Progress: 56%
#&gt; Phase 2 Subphase 3 Iteration 4 Progress: 56%
#&gt; Phase 2 Subphase 3 Iteration 5 Progress: 56%
#&gt; Phase 2 Subphase 3 Iteration 6 Progress: 56%
#&gt; Phase 2 Subphase 3 Iteration 7 Progress: 56%
#&gt; Phase 2 Subphase 3 Iteration 8 Progress: 56%
#&gt; Phase 2 Subphase 3 Iteration 9 Progress: 56%
#&gt; Phase 2 Subphase 3 Iteration 10 Progress: 57%
#&gt; theta  1.908  2.067 -0.218  0.444 
#&gt; ac 0.450 0.556 0.353 0.259 
#&gt; theta:  1.908  2.067 -0.218  0.444 
#&gt; 
#&gt; Start phase 3 </div><div class='output co'>#&gt; Estimated by Maximum Likelihood
#&gt; 
#&gt; Estimates, standard errors and convergence t-ratios
#&gt; 
#&gt;                                        Estimate   Standard   Convergence 
#&gt;                                                     Error      t-ratio   
#&gt;   1. rate constant net rate (period 1)  1.9077  (     NA   )    0.0000   
#&gt;   2. rate constant net rate (period 2)  2.0667  (     NA   )    0.0000   
#&gt;   3. eval outdegree (density)          -0.2182  ( 0.7184   )   -0.2215   
#&gt;   4. eval reciprocity                   0.4439  ( 1.1982   )   -0.1650   
#&gt; 
#&gt; Overall maximum convergence ratio:    0.2267 
#&gt; 
#&gt; 
#&gt; Total of 985 iteration steps.
#&gt; </div><div class='input'><span class='co'># See manual Section 9.1 for information about the following functions</span>
<span class='no'>edges.to.adj</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>n</span>){
<span class='co'># create empty adjacency matrix</span>
    <span class='no'>adj</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0</span>, <span class='no'>n</span>, <span class='no'>n</span>)
<span class='co'># put edge values in desired places</span>
    <span class='no'>adj</span>[<span class='no'>x</span>[, <span class='fl'>1</span>:<span class='fl'>2</span>]] <span class='kw'>&lt;-</span> <span class='no'>x</span>[, <span class='fl'>3</span>]
    <span class='no'>adj</span>
}
<span class='no'>the.edge</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>n</span>,<span class='no'>h</span>,<span class='no'>k</span>){
    <span class='fu'>edges.to.adj</span>(<span class='no'>x</span>,<span class='no'>n</span>)[<span class='no'>h</span>,<span class='no'>k</span>]
}
<span class='co'># Now show the results</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>ego</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep.int</a></span>(<span class='fl'>1</span>:<span class='no'>n</span>,<span class='no'>n</span>)
<span class='no'>alter</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='no'>n</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='no'>n</span>)
<span class='co'># Get the average simulated adjacency matrices for wave 3 (period 2):</span>
<span class='no'>ones</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='fl'>1</span>:<span class='no'>n</span>^<span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>i</span>)
    {<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='no'>ans</span>$<span class='no'>sims</span>,
           <span class='kw'>function</span>(<span class='no'>x</span>){<span class='fu'>the.edge</span>(<span class='no'>x</span><span class='kw'>[[</span><span class='fl'>1</span>]]<span class='kw'>[[</span><span class='fl'>2</span>]]<span class='kw'>[[</span><span class='fl'>1</span>]],<span class='no'>n</span>,<span class='no'>ego</span>[<span class='no'>i</span>],<span class='no'>alter</span>[<span class='no'>i</span>])}))})
<span class='co'># Note that for maximum likelihood estimation,</span>
<span class='co'># if there is one group and one period,</span>
<span class='co'># the nesting levels for group and period are dropped from ans$sims.</span>
<span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>ego</span>,<span class='no'>alter</span>,<span class='no'>ones</span>)</div><div class='output co'>#&gt;       ego alter ones
#&gt;  [1,]   1     1 0.00
#&gt;  [2,]   2     1 1.00
#&gt;  [3,]   3     1 0.00
#&gt;  [4,]   4     1 0.42
#&gt;  [5,]   1     2 1.00
#&gt;  [6,]   2     2 0.00
#&gt;  [7,]   3     2 0.00
#&gt;  [8,]   4     2 1.00
#&gt;  [9,]   1     3 0.00
#&gt; [10,]   2     3 0.00
#&gt; [11,]   3     3 0.00
#&gt; [12,]   4     3 1.00
#&gt; [13,]   1     4 1.00
#&gt; [14,]   2     4 0.00
#&gt; [15,]   3     4 0.00
#&gt; [16,]   4     4 0.00</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='no'>ones</span>,<span class='no'>n</span>,<span class='no'>n</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4]
#&gt; [1,] 0.00    1    0    1
#&gt; [2,] 1.00    0    0    0
#&gt; [3,] 0.00    0    0    0
#&gt; [4,] 0.42    1    1    0</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tom Snijders, Christian Steglich, Johan Koskinen, Christoph Stadtfeld, James Hollway, Per Block, Nynke Niezink, Viviana Amati, Robert Krause.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


