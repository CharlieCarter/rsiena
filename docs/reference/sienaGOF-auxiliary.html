<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Auxiliary functions for goodness of fit assessment by <code><a href='sienaGOF.html'>sienaGOF</a></code> — sienaGOF-auxiliary • RSiena</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Auxiliary functions for goodness of fit assessment by <code><a href='sienaGOF.html'>sienaGOF</a></code> — sienaGOF-auxiliary" />
<meta property="og:description" content="The functions given here are auxiliary to function sienaGOF
 which assesses goodness of fit for actor-oriented models.
The auxiliary functions are, first, some functions of networks or behavior
 (i.e., statistics) for which the simulated values for the fitted model
 are compared to the observed value; second, some extraction functions
 to extract the observed and simulated networks and/or behavior
 from the sienaFit object produced by siena07
 with returnDeps=TRUE.
These functions are exported here mainly to enable users to write
 their own versions. At the end of this help page some non-exported functions
 are listed. These are not exported because they depend on packages that
 are not in the R base distribution; and to show templates for readers
 wishing to contruct their own functions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RSiena</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2-25</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">In the package</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Auxiliary functions for goodness of fit assessment by <code><a href='sienaGOF.html'>sienaGOF</a></code></h1>
    
    <div class="hidden name"><code>sienaGOF-auxiliary.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The functions given here are auxiliary to function <code><a href='sienaGOF.html'>sienaGOF</a></code>
 which assesses goodness of fit for actor-oriented models.</p>
<p>The auxiliary functions are, first, some functions of networks or behavior
 (i.e., statistics) for which the simulated values for the fitted model
 are compared to the observed value; second, some extraction functions
 to extract the observed and simulated networks and/or behavior
 from the <code><a href='sienaFit.html'>sienaFit</a></code> object produced by <code><a href='siena07.html'>siena07</a></code>
 with <code>returnDeps=TRUE</code>.</p>
<p>These functions are exported here mainly to enable users to write
 their own versions. At the end of this help page some non-exported functions
 are listed. These are not exported because they depend on packages that
 are not in the R base distribution; and to show templates for readers
 wishing to contruct their own functions.</p>
    </div>

    <pre class="usage"><span class='fu'>OutdegreeDistribution</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>,
         <span class='kw'>levls</span><span class='kw'>=</span><span class='fl'>0</span>:<span class='fl'>8</span>, <span class='kw'>cumulative</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='fu'>IndegreeDistribution</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>,
         <span class='kw'>levls</span><span class='kw'>=</span><span class='fl'>0</span>:<span class='fl'>8</span>, <span class='kw'>cumulative</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='fu'>BehaviorDistribution</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>,
         <span class='kw'>levls</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>cumulative</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='fu'>TriadCensus</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>, <span class='kw'>levls</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>16</span>)

<span class='fu'>mixedTriadCensus</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>)

<span class='fu'>dyadicCov</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>, <span class='no'>dc</span>)

<span class='fu'>sparseMatrixExtraction</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>)

<span class='fu'>networkExtraction</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>)

<span class='fu'>behaviorExtraction</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>i</th>
      <td><p>Index number of simulation to be extracted, ranging from 1 to
    <code><a href='https://rdrr.io/r/base/length.html'>length(sims)</a></code>; if NULL, the data observation will be extracted.</p></td>
    </tr>
    <tr>
      <th>obsData</th>
      <td><p>The observed data set to which the model was fitted; normally
    this is <code>x$f</code> where <code>x</code> is the <code><a href='sienaFit.html'>sienaFit</a></code>
    object for which the fit is being assessed.</p></td>
    </tr>
    <tr>
      <th>sims</th>
      <td><p>The simulated data sets to be compared with the observed data;
    normally this is
    <code>x$sims</code> where <code>x</code> is the <code><a href='sienaFit.html'>sienaFit</a></code>
    object for which the fit is being assessed.</p></td>
    </tr>
    <tr>
      <th>period</th>
      <td><p>Period for which data and simulations are used (may run from
    1 to number of waves - 1).</p></td>
    </tr>
    <tr>
      <th>groupName</th>
      <td><p>Name of group; relevant for multi-group data sets;
    defaults in <code><a href='sienaGOF.html'>sienaGOF</a></code> to "<code>Data1</code>".</p></td>
    </tr>
    <tr>
      <th>varName</th>
      <td><p>Name of dependent variable.</p></td>
    </tr>
    <tr>
      <th>levls</th>
      <td><p>Levels used as values of the auxiliary statistic.
    For <code>BehaviorDistribution</code>, this defaults to the observed
    range of values.</p></td>
    </tr>
    <tr>
      <th>cumulative</th>
      <td><p>Are the distributions to be considered as raw or
    cumulative (&lt;=) distributions?</p></td>
    </tr>
    <tr>
      <th>dc</th>
      <td><p>Dyadic covariate: matrix with the same dimensions as
    adjacency matrix for dependent network variable.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The statistics should be chosen to represent features of the network
 that are not explicitly fit by the estimation procedure but can be
 considered important properties that the model at hand should represent well.
 The three given here are far from a complete set;
 they will be supplemented in due time by statistics depending on networks and
 behavior jointly.
 The examples below give a number of other statistics, using the packages
 sna and igraph.</p>
<p>The <code>levls</code> parameter must be adapted to the range of values that is
 considered important. For indegrees and outdegrees, the whole range should
 usually be covered. If the range is large, which could be the case, e.g.,
 for indegrees of two-mode networks where the second mode has few nodes,
 think about the possibility of making a selection such as
 <code>levls=5*(0:20)</code> or <code>levls=c(0:4,5*(1:20))</code>;
 which in most cases will make sense only if <code>cumulative=TRUE</code>.</p>
<p>The method signature for the auxiliary statistics generally is<br />
 <code>function(i, obsData, sims, period, groupName, varName, ...)</code>.
 For constructing new auxiliary statistics, it is helpful to
 study the code of <code>OutdegreeDistribution</code>, <code>IndegreeDistribution</code>,
 and <code>BehaviorDistribution</code> and of the example functions below.</p>
<p><code>TriadCensus</code> returns the distribution of the Holland-Leinhardt triad
 census according to the algorithm by Batagelj and Mrvar
 (implementation by Parimalarangan Slota, and Madduri). An alternative is the
 <code>TriadCensus.sna</code> function mentioned below, from package <code>sna</code>, which
 gives the same results. Here the <code>levls</code> parameter can be used to exclude
 some triads, e.g., for non-directed networks.<br />
 The Batagelj-Mrvar algorithm is optimized for sparse, large graphs and may be
 much faster than the procedure implemented in <code>sna</code>. For dense graphs
 the <code>sna</code> procedure may be faster.</p>
<p><code>dyadicCov</code> assumes that <code>dc</code> is a categorical dyadic variable,
 and returns the frequencies of the non-zero values for realized ties.
 Since zero values of dc are not counted, it may be advisable
 to code dc so that all non-diagonal values are non-zero,
 and all diagonal values are zero.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>OutdegreeDistribution</code> returns a named vector, the distribution
  of the observed or simulated outdegrees for the values in <code>levls</code>.</p>
<p><code>IndegreeDistribution</code> returns a named vector, the distribution
  of the observed or simulated indegrees for the values in <code>levls</code>.</p>
<p><code>BehaviorDistribution</code> returns a named vector, the distribution of the
  observed or simulated behavioral variable for the values in <code>levls</code>.</p>
<p><code>TriadCensus</code> returns a named vector, the distribution of the
  Holland-Leinhardt triad census according to the algorithm by Batagelj and Mrvar.</p>
<p><code>mixedTriadCensus</code> returns a named vector, the distribution of the
  mixed triad census of Hollway, Lomi, Pallotti,and Stadtfeld (2017).</p>
<p><code>dyadicCov</code> returns a named vector, the frequencies of the non-missing
  non-zero values dc(ego,alter) of the observed or simulated (ego,alter) ties.</p>
<p><code>sparseMatrixExtraction</code> returns the simulated network as a
  <code>dgCMatrix</code>;
  this is the "standard" class for sparse numeric matrices in the
  <code>Matrix</code> package. See the help file for <code>dgCMatrix-class</code>.<br />
  Tie variables for ordered pairs with a missing value for wave=period or
  period+1 are zeroed;
  note that this also is done in RSiena for calculation of target statistics.
  Tie variables that are structurally determined at the beginning of a period
  are used to replace observed values at the end of the period;
  tie variables that are structurally determined at the end, but not
  the beginning, of a period are used to replace
  simulated values at the end of the period.
  <br />
  To treat the objects returned by this function as regular matrices,
  it is necessary to attach the <code>Matrix</code> package in your session.</p>
<p><code>networkExtraction</code> returns the network as an edge list of class "network"
  according to the network package (used for package sna).
  Missing values and structural values are treated as in
  <code>sparseMatrixExtraction</code>, see above.</p>
<p><code>behaviorExtraction</code> returns the dependent behavior
  variable as an integer vector.
  Values for actors with a missing value for wave=period or period+1 are
  transformed to NA.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Batagelj, V., and Mrvar, A. (2001).
  A subquadratic triad census algorithm for large sparse networks with small
  maximum degree. <em>Social Networks</em>, 23, 237-243.</p></li>
<li><p>See <a href='http://www.stats.ox.ac.uk/~snijders/siena/'>http://www.stats.ox.ac.uk/~snijders/siena/</a>
  for general information on RSiena.</p></li>
<li><p>Holland, P.W., and Leinhardt, S. (1976).
  Local structure in social networks. <em>Sociological Methodology</em>, 6, 1-45.</p></li>
<li><p>Hollway, J., Lomi, A., Pallotti, F., and Stadtfeld, C. (2017)
   Multilevel social spaces: The network dynamics of organizational fields.
   <em>Network Science</em>, 5(2), 187-212.</p></li>
<li><p>Lospinoso, J.A. and Snijders, T.A.B. (2019).
  Goodness of fit for stochastic actor-orientedmodels.
  <em>Methodological Innovations</em>, 12:2059799119884282.</p></li>
<li><p>Parimalarangan S., Slota, G.M., and Madduri, K. (2017).
 Fast parallel graph triad census and triangle counting on shared-memory platforms,
 2017 IEEE International Parallel and Distributed Processing Symposium Workshops
 (IPDPSW), Lake Buena Vista, FL, pp. 1500-1509.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='siena07.html'>siena07</a></code>, <code><a href='sienaGOF.html'>sienaGOF</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### For use out of the box:</span>

<span class='no'>mynet1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>s501</span>, <span class='no'>s502</span>), <span class='kw'>dim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>50</span>, <span class='fl'>2</span>)))
<span class='no'>mybeh</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='no'>s50a</span>[,<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"behavior"</span>)
<span class='no'>mycov</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>,<span class='fl'>16</span>),<span class='fl'>1</span>,<span class='fl'>2</span>) <span class='co'># artificial, just for trying</span>
<span class='no'>mydycov</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='fl'>500</span>), <span class='fl'>50</span>, <span class='fl'>50</span>) <span class='co'># also artificial, just for trying</span>
<span class='no'>mydata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDataCreate.html'>sienaDataCreate</a></span>(<span class='no'>mynet1</span>, <span class='no'>mybeh</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getEffects.html'>getEffects</a></span>(<span class='no'>mydata</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>myeff</span>, <span class='no'>transTies</span>, <span class='no'>cycle3</span>)</div><div class='output co'>#&gt;   effectName      include fix   test  initialValue parm
#&gt; 1 3-cycles        TRUE    FALSE FALSE          0   0   
#&gt; 2 transitive ties TRUE    FALSE FALSE          0   0   </div><div class='input'><span class='co'># Shorter phases 2 and 3, just for example:</span>
<span class='no'>myalgorithm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></span>(<span class='kw'>nsub</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>n3</span><span class='kw'>=</span><span class='fl'>50</span>, <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>122</span>, <span class='kw'>projname</span><span class='kw'>=</span><span class='kw'>NULL</span>)</div><div class='output co'>#&gt; If you use this algorithm object, siena07 will create an output file /var/folders/pl/ngry9kn13p7466xwk0_2xyh40000gn/T//RtmpNeONkK/Siena3ebf252bee87.txt .
#&gt; This is a temporary file for this R session.</div><div class='input'>(<span class='no'>ans</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='siena07.html'>siena07</a></span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>returnDeps</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
   <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>))</div><div class='output co'>#&gt; 
#&gt; Start phase 0 
#&gt; theta:  4.696 -1.489  0.000  0.000  0.000  0.706  0.322  0.000 
#&gt; 
#&gt; Start phase 1 
#&gt; Phase 1 Iteration 1 Progress: 0%
#&gt; Phase 1 Iteration 2 Progress: 0%
#&gt; Phase 1 Iteration 3 Progress: 0%
#&gt; Phase 1 Iteration 4 Progress: 1%
#&gt; Phase 1 Iteration 5 Progress: 1%
#&gt; Phase 1 Iteration 10 Progress: 1%
#&gt; Phase 1 Iteration 15 Progress: 2%
#&gt; Phase 1 Iteration 20 Progress: 3%
#&gt; Phase 1 Iteration 25 Progress: 3%
#&gt; Phase 1 Iteration 30 Progress: 4%
#&gt; Phase 1 Iteration 35 Progress: 5%
#&gt; Phase 1 Iteration 40 Progress: 5%
#&gt; Phase 1 Iteration 45 Progress: 6%
#&gt; Phase 1 Iteration 50 Progress: 7%
#&gt; theta:  5.626 -1.765  0.513  0.244  0.295  0.401  0.277  0.102 
#&gt; 
#&gt; Start phase 2.1
#&gt; Phase 2 Subphase 1 Iteration 1 Progress: 61%
#&gt; Phase 2 Subphase 1 Iteration 2 Progress: 61%
#&gt; theta  6.222 -1.910  0.847  0.400  0.589  0.383  0.139  0.150 
#&gt; ac  0.527  0.050  2.786  6.110  5.883  1.014  0.922 -2.652 
#&gt; Phase 2 Subphase 1 Iteration 3 Progress: 61%
#&gt; Phase 2 Subphase 1 Iteration 4 Progress: 62%
#&gt; theta  6.2239 -2.1219  1.2821  0.0671  0.6807  0.8771  0.2755  0.1887 
#&gt; ac  0.992  1.239  1.230 -3.756  2.550  1.108  1.351  0.193 
#&gt; Phase 2 Subphase 1 Iteration 5 Progress: 62%
#&gt; Phase 2 Subphase 1 Iteration 6 Progress: 62%
#&gt; theta  6.422 -2.392  1.720  0.214  0.799  1.117  0.269  0.136 
#&gt; ac  0.910  1.271  1.301 -3.605  1.196  1.118  1.252  0.303 
#&gt; Phase 2 Subphase 1 Iteration 7 Progress: 62%
#&gt; Phase 2 Subphase 1 Iteration 8 Progress: 62%
#&gt; theta  6.6477 -2.5994  1.9545  0.2903  0.9594  1.1115  0.3731  0.0797 
#&gt; ac  0.743  1.274  1.310 -3.464  0.987  0.953  1.292  0.470 
#&gt; Phase 2 Subphase 1 Iteration 9 Progress: 62%
#&gt; Phase 2 Subphase 1 Iteration 10 Progress: 62%
#&gt; theta  6.5262 -2.7189  2.0723  0.4106  1.0502  1.1184  0.3314 -0.0143 
#&gt; ac  0.7050  1.2030  0.5857 -2.1894  0.0142  0.9217  1.1864  0.2257 
#&gt; theta  6.6463 -2.6155  1.9720  0.2869  0.8550  1.2018  0.3186 -0.0498 
#&gt; ac  0.17818 -0.61049 -0.69343 -0.61515 -0.73885  0.00491 -0.31594  0.01206 
#&gt; theta:  6.6463 -2.6155  1.9720  0.2869  0.8550  1.2018  0.3186 -0.0498 
#&gt; 
#&gt; Start phase 3 </div><div class='output co'>#&gt; Estimates, standard errors and convergence t-ratios
#&gt; 
#&gt;                                       Estimate   Standard   Convergence 
#&gt;                                                    Error      t-ratio   
#&gt; Network Dynamics 
#&gt;   1. rate basic rate parameter mynet1  6.6463  ( 3.6467   )   -0.0572   
#&gt;   2. eval outdegree (density)         -2.6155  ( 0.2693   )   -0.4537   
#&gt;   3. eval reciprocity                  1.9720  ( 0.2606   )   -0.4184   
#&gt;   4. eval 3-cycles                     0.2869  ( 0.3186   )   -0.5529   
#&gt;   5. eval transitive ties              0.8550  ( 0.2896   )   -0.3299   
#&gt; 
#&gt; Behavior Dynamics
#&gt;   6. rate rate mybeh period 1          1.2018  ( 0.3102   )    0.0240   
#&gt;   7. eval mybeh linear shape           0.3186  ( 0.1805   )   -0.2794   
#&gt;   8. eval mybeh quadratic shape       -0.0498  ( 0.5535   )   -0.2177   
#&gt; 
#&gt; Overall maximum convergence ratio:    0.8551 
#&gt; 
#&gt; 
#&gt; Total of 337 iteration steps.
#&gt; </div><div class='input'>
<span class='co'># NULL for the observations:</span>
<span class='fu'>OutdegreeDistribution</span>(<span class='kw'>NULL</span>, <span class='no'>ans</span>$<span class='no'>f</span>, <span class='no'>ans</span>$<span class='no'>sims</span>, <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>groupName</span><span class='kw'>=</span><span class='st'>"Data1"</span>,
  <span class='kw'>levls</span><span class='kw'>=</span><span class='fl'>0</span>:<span class='fl'>7</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)</div><div class='output co'>#&gt;  0  1  2  3  4  5  6  7 
#&gt;  3 15 27 42 47 50 50 50 </div><div class='input'><span class='fu'>dyadicCov</span>(<span class='kw'>NULL</span>, <span class='no'>ans</span>$<span class='no'>f</span>, <span class='no'>ans</span>$<span class='no'>sims</span>, <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>groupName</span><span class='kw'>=</span><span class='st'>"Data1"</span>,
  <span class='kw'>dc</span><span class='kw'>=</span><span class='no'>mydycov</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)</div><div class='output co'>#&gt;  1  2  3  4  5 
#&gt; 31 25 14 23 23 </div><div class='input'><span class='co'># An arbitrary selection for simulation run i:</span>
<span class='fu'>IndegreeDistribution</span>(<span class='fl'>5</span>, <span class='no'>ans</span>$<span class='no'>f</span>, <span class='no'>ans</span>$<span class='no'>sims</span>, <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>groupName</span><span class='kw'>=</span><span class='st'>"Data1"</span>,
  <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)</div><div class='output co'>#&gt;  0  1  2  3  4  5  6  7  8 
#&gt; 10 19 31 39 47 49 49 50 50 </div><div class='input'><span class='fu'>BehaviorDistribution</span>(<span class='fl'>20</span>, <span class='no'>ans</span>$<span class='no'>f</span>, <span class='no'>ans</span>$<span class='no'>sims</span>, <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>groupName</span><span class='kw'>=</span><span class='st'>"Data1"</span>,
  <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mybeh"</span>)</div><div class='output co'>#&gt;  1  2  3  4  5 
#&gt;  2 14 30 41 50 </div><div class='input'><span class='fu'>sparseMatrixExtraction</span>(<span class='fl'>50</span>, <span class='no'>ans</span>$<span class='no'>f</span>, <span class='no'>ans</span>$<span class='no'>sims</span>, <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>groupName</span><span class='kw'>=</span><span class='st'>"Data1"</span>,
  <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)</div><div class='output co'>#&gt; 50 x 50 sparse Matrix of class "dgCMatrix"
#&gt;                                                                                
#&gt;  [1,] . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . .
#&gt;  [2,] . . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt;  [3,] . . . 1 . . . . 1 . . . . . . . 1 . . . . . . . . . . . . . . . . . . . .
#&gt;  [4,] . . 1 . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt;  [5,] . . . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . . . . . . . .
#&gt;  [6,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 . . . . . . .
#&gt;  [7,] . . . . . . . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt;  [8,] . . . . . . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . . . . .
#&gt;  [9,] . . 1 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [10,] . . . . . . . . . . 1 . . . 1 . . . . . . . . . . . . . . . . 1 . . . . .
#&gt; [11,] . . . . . . . . . 1 . . . . 1 1 . . . . . . . . . . . . . . . . . . . . .
#&gt; [12,] . . . . . . 1 . . . 1 . . . . . . . . . . . . . . . . . . . . . . . 1 . .
#&gt; [13,] . . . . . . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [14,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [15,] . . . . . . . . . 1 . . . . . 1 . . . . . . . . . . . . . . . . . . . . .
#&gt; [16,] . . . . . . . . . . 1 . . . 1 . . . . . . . . . . . . . . . . . . . . . .
#&gt; [17,] . . . . . . . . . . . . . . . . . . 1 . . 1 . 1 . . . . . . . . . . . . .
#&gt; [18,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [19,] . . . . . . . . . . . . . . . . 1 . . . . . . 1 . . . . . . . . . . . . .
#&gt; [20,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [21,] . . . . . . . . . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . .
#&gt; [22,] . . . . . . . . . . . . . . . . 1 . 1 . 1 . . . . . . . . . 1 . . . . . .
#&gt; [23,] . . . . . . . . . . . . . . . 1 . 1 . . . . . . . . . . . . . . . . . . .
#&gt; [24,] . . . . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . . . . . . .
#&gt; [25,] . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [26,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 . . . . . . .
#&gt; [27,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [28,] . . . . . . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . . . . .
#&gt; [29,] . . . . . . . . . . . . . . . . . . . . . . . . . 1 . . . 1 . . . . . . .
#&gt; [30,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 . . . .
#&gt; [31,] . . . . . . . . . . . . . . . . . . . . . 1 . . . . . . . . . 1 . . . . 1
#&gt; [32,] . . . . . . . . . 1 . . . . . . . . . . . . . . . . . . . . 1 . . . . . .
#&gt; [33,] . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . 1 . . . . . . .
#&gt; [34,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 . . . . . 1
#&gt; [35,] . . . . . 1 . . . . . . . . . . . 1 . . . . . . . . . . . . . . . . . . .
#&gt; [36,] . . . . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [37,] . . . . . . . . . . . . . 1 . . . . . . . . . . . . . . . . 1 1 . . . . .
#&gt; [38,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 .
#&gt; [39,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [40,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [41,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 .
#&gt; [42,] . . . . . . 1 . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [43,] . . . . . . . . . . . . . . . . . . . . . 1 . . . . . . . . . . . . 1 . .
#&gt; [44,] . . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [45,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [46,] . . . . . . 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [47,] . . . . . . . . 1 . . . . . . . . . . . . . . . 1 . . . . . 1 1 . . . . .
#&gt; [48,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt; [49,] . . . . . . . . . . . . . . . . 1 . . . 1 . . 1 . . . . . . . 1 . . . . .
#&gt; [50,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
#&gt;                                
#&gt;  [1,] . . . . . . . . . . . . .
#&gt;  [2,] . . . . . . . . . . . . .
#&gt;  [3,] . . . . . . . . . . . . .
#&gt;  [4,] . . 1 . . . . . . . . . .
#&gt;  [5,] . . . . . . . . . . . . .
#&gt;  [6,] . . . . . . . . . . . . .
#&gt;  [7,] . . . . 1 1 1 . . . . . .
#&gt;  [8,] . . . . . 1 . . . . . . .
#&gt;  [9,] . . . . . . . . . . . . .
#&gt; [10,] . . . . . . . . . . . . .
#&gt; [11,] . . . . . . . . . . . . .
#&gt; [12,] . . . . 1 . . . . . . . .
#&gt; [13,] . . . . . . . . . . . . .
#&gt; [14,] . . . . . . . . . . . . .
#&gt; [15,] . . . . . . . . . . . . .
#&gt; [16,] . . . . . . . . . . . . .
#&gt; [17,] . . . . . . . . . . . . .
#&gt; [18,] . . . . . . . . . . . . .
#&gt; [19,] . . . . . . . . . . . . .
#&gt; [20,] . . . . . . . . . . . . .
#&gt; [21,] . . . . . . . . . . . . .
#&gt; [22,] . . . . . 1 . . . . . . .
#&gt; [23,] . . . . . . . . . . . . .
#&gt; [24,] . . . . . . . . . . . . .
#&gt; [25,] . . . . . . . . . . . . .
#&gt; [26,] . . . . . . . . . . . . .
#&gt; [27,] . . . . . . . . . . . . .
#&gt; [28,] . . . . . . . . . . . . .
#&gt; [29,] . . . . . . . . . . . . .
#&gt; [30,] . . . . . . . . . . . . .
#&gt; [31,] . . . . . . . . . . . . .
#&gt; [32,] . . 1 . . . . . . 1 . . .
#&gt; [33,] . . . . . . . . . . . . .
#&gt; [34,] . . . . . . . . . . . . .
#&gt; [35,] . . . . . . . . . . . . .
#&gt; [36,] 1 . . 1 . . . . . . . . .
#&gt; [37,] . . . . . . . . . . . . .
#&gt; [38,] . . . 1 . . . . . . . . .
#&gt; [39,] . . . . . . . . . . . . .
#&gt; [40,] . . . . . . . . . . . . .
#&gt; [41,] 1 . . . . . . . . . . . .
#&gt; [42,] . . . . . . 1 . . . . . .
#&gt; [43,] . . . . . . . . . . . . .
#&gt; [44,] . . . . 1 . . . . . . . .
#&gt; [45,] . . . . . . . . . . . . .
#&gt; [46,] . . . . . . 1 . . . . . .
#&gt; [47,] . . . . . . . . . . 1 . .
#&gt; [48,] . . . 1 . . . . . . . . .
#&gt; [49,] . . . . . . . . . . . . .
#&gt; [50,] . . . . . . . . . . . . .</div><div class='input'><span class='fu'>networkExtraction</span>(<span class='fl'>40</span>, <span class='no'>ans</span>$<span class='no'>f</span>, <span class='no'>ans</span>$<span class='no'>sims</span>, <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>groupName</span><span class='kw'>=</span><span class='st'>"Data1"</span>,
  <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)</div><div class='output co'>#&gt;  Network attributes:
#&gt;   vertices = 50 
#&gt;   directed = TRUE 
#&gt;   hyper = FALSE 
#&gt;   loops = FALSE 
#&gt;   multiple = FALSE 
#&gt;   total edges= 100 
#&gt;     missing edges= 0 
#&gt;     non-missing edges= 100 
#&gt; 
#&gt;  Vertex attribute names: 
#&gt;     vertex.names 
#&gt; 
#&gt; No edge attributes</div><div class='input'><span class='fu'>behaviorExtraction</span>(<span class='fl'>50</span>, <span class='no'>ans</span>$<span class='no'>f</span>, <span class='no'>ans</span>$<span class='no'>sims</span>, <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>groupName</span><span class='kw'>=</span><span class='st'>"Data1"</span>,
  <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mybeh"</span>)</div><div class='output co'>#&gt;  [1] 3 2 3 3 4 3 4 4 2 4 5 5 1 4 3 4 2 4 4 2 2 3 5 3 4 4 2 3 3 1 5 4 3 2 2 4 1 3
#&gt; [39] 2 2 4 5 1 5 2 2 3 2 1 1</div><div class='input'>
<span class='no'>gofi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans</span>, <span class='no'>IndegreeDistribution</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
  <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)</div><div class='output co'>#&gt; <span class='message'>Detected50iterations and1group.</span></div><div class='output co'>#&gt; Calculating auxiliary statistics for period  1 .</div><div class='output co'>#&gt; <span class='message'>  Period 1</span></div><div class='output co'>#&gt;   &gt; Completed  50  calculations
#&gt; </div><div class='input'><span class='no'>gofi</span></div><div class='output co'>#&gt; Siena Goodness of Fit ( IndegreeDistribution ), all periods
#&gt; =====
#&gt; Monte Carlo Mahalanobis distance test p-value:  0.74 
#&gt; -----
#&gt; One tailed test used  (i.e. estimated probability of greater distance than observation).
#&gt; -----
#&gt; Calculated joint MHD = ( 4.73 ) for current model.</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofi</span>)</div><div class='img'><img src='sienaGOF-auxiliary-1.png' alt='' width='700' height='433' /></div><div class='input'>
(<span class='no'>gofo</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans</span>, <span class='no'>OutdegreeDistribution</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
    <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>, <span class='kw'>cumulative</span><span class='kw'>=</span><span class='fl'>FALSE</span>))</div><div class='output co'>#&gt; <span class='message'>Detected50iterations and1group.</span></div><div class='output co'>#&gt; Calculating auxiliary statistics for period  1 .</div><div class='output co'>#&gt; <span class='message'>  Period 1</span></div><div class='output co'>#&gt;   &gt; Completed  50  calculations
#&gt; </div><div class='output co'>#&gt; Siena Goodness of Fit ( OutdegreeDistribution ), all periods
#&gt; =====
#&gt; Monte Carlo Mahalanobis distance test p-value:  0.46 
#&gt; **Note: Only 8 statistics are necessary in the auxiliary function.
#&gt; -----
#&gt; One tailed test used  (i.e. estimated probability of greater distance than observation).
#&gt; -----
#&gt; Calculated joint MHD = ( 7.55 ) for current model.</div><div class='input'><span class='co'># cumulative is an example of "\dots".</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofo</span>)</div><div class='img'><img src='sienaGOF-auxiliary-2.png' alt='' width='700' height='433' /></div><div class='input'>
(<span class='no'>gofdc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans</span>, <span class='no'>dyadicCov</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
    <span class='kw'>dc</span><span class='kw'>=</span><span class='no'>mydycov</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>))</div><div class='output co'>#&gt; <span class='message'>Detected50iterations and1group.</span></div><div class='output co'>#&gt; Calculating auxiliary statistics for period  1 .</div><div class='output co'>#&gt; <span class='message'>  Period 1</span></div><div class='output co'>#&gt;   &gt; Completed  50  calculations
#&gt; </div><div class='output co'>#&gt; Siena Goodness of Fit ( dyadicCov ), all periods
#&gt; =====
#&gt; Monte Carlo Mahalanobis distance test p-value:  0.84 
#&gt; -----
#&gt; One tailed test used  (i.e. estimated probability of greater distance than observation).
#&gt; -----
#&gt; Calculated joint MHD = ( 2.28 ) for current model.</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofdc</span>)</div><div class='img'><img src='sienaGOF-auxiliary-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># How to use dyadicCov for ego-alter combinations of a monadic variable:</span>
<span class='no'>mycov.egoalter</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>(<span class='fl'>10</span>*<span class='no'>mycov</span>, <span class='no'>mycov</span> ,<span class='st'>'+'</span>)
<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>mycov.egoalter</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='no'>mycov.egoalter</span>) <span class='co'># 50 * 50 matrix</span></div><div class='output co'>#&gt; [1] 50 50</div><div class='input'><span class='co'># This is a dyadic variable indicating ego-alter combinations of mycov.</span>
<span class='co'># This construction works since mycov has integer values </span>
<span class='co'># not outside the interval from 1 to 9.</span>
<span class='co'># All cells of this matrix contain a two-digit number,</span>
<span class='co'># left digit is row (ego) value, right digit is column (alter) value.</span>
<span class='co'># See the top left part of the matrix:</span>
<span class='no'>mycov.egoalter</span>[<span class='fl'>1</span>:<span class='fl'>10</span>,<span class='fl'>1</span>:<span class='fl'>12</span>]</div><div class='output co'>#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
#&gt;  [1,]    0   12   13   11   12   13   11   12   13    11    12    13
#&gt;  [2,]   21    0   23   21   22   23   21   22   23    21    22    23
#&gt;  [3,]   31   32    0   31   32   33   31   32   33    31    32    33
#&gt;  [4,]   11   12   13    0   12   13   11   12   13    11    12    13
#&gt;  [5,]   21   22   23   21    0   23   21   22   23    21    22    23
#&gt;  [6,]   31   32   33   31   32    0   31   32   33    31    32    33
#&gt;  [7,]   11   12   13   11   12   13    0   12   13    11    12    13
#&gt;  [8,]   21   22   23   21   22   23   21    0   23    21    22    23
#&gt;  [9,]   31   32   33   31   32   33   31   32    0    31    32    33
#&gt; [10,]   11   12   13   11   12   13   11   12   13     0    12    13</div><div class='input'><span class='co'># The number of values is the square of the number of values of mycov;</span>
<span class='co'># therefore, unwise to do this for a monadic covariate with more than 5 values.</span>
<span class='no'>gof.mycov</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans</span>, <span class='no'>dyadicCov</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>,
    <span class='kw'>dc</span><span class='kw'>=</span><span class='no'>mycov.egoalter</span>)</div><div class='output co'>#&gt; <span class='message'>Detected50iterations and1group.</span></div><div class='output co'>#&gt; Calculating auxiliary statistics for period  1 .</div><div class='output co'>#&gt; <span class='message'>  Period 1</span></div><div class='output co'>#&gt;   &gt; Completed  50  calculations
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gof.mycov</span>)</div><div class='img'><img src='sienaGOF-auxiliary-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='sienaGOF.html'>descriptives.sienaGOF</a></span>(<span class='no'>gof.mycov</span>, <span class='kw'>showAll</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;               11    12    13    21    22    23    31    32    33
#&gt; max        23.00 18.00 22.00 21.00 19.00 21.00 21.00 19.00 14.00
#&gt; perc.upper 23.00 17.00 21.00 19.00 19.00 19.00 19.00 18.00 13.00
#&gt; mean       12.96 11.98 14.36 12.32 10.46 13.54 14.28 13.16  8.50
#&gt; median     13.00 12.00 14.00 12.00 10.00 13.00 14.00 13.00  9.00
#&gt; perc.lower  5.00  4.00  9.00  6.00  2.00  8.00  7.00  8.00  3.00
#&gt; min         5.00  4.00  9.00  6.00  2.00  8.00  7.00  8.00  3.00
#&gt; obs        12.00 12.00 17.00 19.00  8.00 11.00 15.00 13.00  9.00
#&gt; p&gt;          0.56  0.48  0.14  0.02  0.64  0.76  0.38  0.48  0.44
#&gt; p&gt;=         0.60  0.54  0.24  0.04  0.80  0.84  0.50  0.54  0.56</div><div class='input'>
(<span class='no'>gofb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans</span>, <span class='no'>BehaviorDistribution</span>, <span class='kw'>varName</span> <span class='kw'>=</span> <span class='st'>"mybeh"</span>,
    <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>cumulative</span><span class='kw'>=</span><span class='fl'>FALSE</span>))</div><div class='output co'>#&gt; <span class='message'>Detected50iterations and1group.</span></div><div class='output co'>#&gt; Calculating auxiliary statistics for period  1 .</div><div class='output co'>#&gt; <span class='message'>  Period 1</span></div><div class='output co'>#&gt;   &gt; Completed  50  calculations
#&gt; </div><div class='output co'>#&gt; Siena Goodness of Fit ( BehaviorDistribution ), all periods
#&gt; =====
#&gt; Monte Carlo Mahalanobis distance test p-value:  0.52 
#&gt; **Note: Only 4 statistics are necessary in the auxiliary function.
#&gt; -----
#&gt; One tailed test used  (i.e. estimated probability of greater distance than observation).
#&gt; -----
#&gt; Calculated joint MHD = ( 3.15 ) for current model.</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofb</span>)</div><div class='img'><img src='sienaGOF-auxiliary-5.png' alt='' width='700' height='433' /></div><div class='input'>
(<span class='no'>goftc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans</span>, <span class='no'>TriadCensus</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
    <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>))</div><div class='output co'>#&gt; <span class='message'>Detected50iterations and1group.</span></div><div class='output co'>#&gt; Calculating auxiliary statistics for period  1 .</div><div class='output co'>#&gt; <span class='message'>  Period 1</span></div><div class='output co'>#&gt;   &gt; Completed  50  calculations
#&gt; </div><div class='output co'>#&gt; Siena Goodness of Fit ( TriadCensus ), all periods
#&gt; =====
#&gt; Monte Carlo Mahalanobis distance test p-value:  0 
#&gt; **Note: Only 15 statistics are necessary in the auxiliary function.
#&gt; -----
#&gt; One tailed test used  (i.e. estimated probability of greater distance than observation).
#&gt; -----
#&gt; Calculated joint MHD = ( 50.33 ) for current model.</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>goftc</span>, <span class='kw'>center</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='img'><img src='sienaGOF-auxiliary-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># For this type of auxiliary statistics</span>
<span class='co'># it is advisable in the plot to center and scale.</span>
<span class='co'># note the keys at the x-axis (widen the plot if they are not clear).</span>
<span class='fu'><a href='sienaGOF.html'>descriptives.sienaGOF</a></span>(<span class='no'>goftc</span>)</div><div class='output co'>#&gt;                 003     012     102  021D  021U  021C  111D  111U 030T 030C
#&gt; max        16782.00 2472.00 1889.00 28.00 35.00 65.00 75.00 73.00 4.00 4.00
#&gt; perc.upper 16726.00 2297.00 1735.00 23.00 31.00 56.00 74.00 73.00 3.00 2.00
#&gt; mean       16068.20 1917.10 1401.36 13.84 18.96 37.00 50.72 48.08 1.20 0.28
#&gt; median     16045.00 1935.00 1382.00 13.00 19.00 36.00 51.00 49.00 1.00 0.00
#&gt; perc.lower 15573.00 1391.00 1048.00  5.00 10.00 19.00 30.00 24.00 0.00 0.00
#&gt; min        15573.00 1391.00 1048.00  5.00 10.00 19.00 30.00 24.00 0.00 0.00
#&gt; obs        15927.00 1956.00 1530.00 24.00 19.00 30.00 46.00 26.00 2.00 0.00
#&gt; p&gt;             0.66    0.38    0.24  0.02  0.42  0.74  0.74  0.96 0.08 0.20
#&gt; p&gt;=            0.66    0.40    0.24  0.02  0.52  0.76  0.74  0.96 0.38 1.00
#&gt;              201 120D 120U 120C   210   300
#&gt; max        40.00 5.00 4.00 7.00 15.00 13.00
#&gt; perc.upper 38.00 5.00 4.00 6.00 14.00 13.00
#&gt; mean       22.84 2.14 1.58 2.28  7.26  7.16
#&gt; median     22.00 2.00 1.00 2.00  6.00  7.00
#&gt; perc.lower  6.00 0.00 0.00 0.00  1.00  4.00
#&gt; min         6.00 0.00 0.00 0.00  1.00  4.00
#&gt; obs        14.00 4.00 1.00 4.00 10.00  7.00
#&gt; p&gt;          0.84 0.04 0.48 0.10  0.16  0.34
#&gt; p&gt;=         0.86 0.12 0.88 0.26  0.26  0.56</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fu'><a href='sienaGOF.html'>descriptives.sienaGOF</a></span>(<span class='no'>goftc</span>, <span class='kw'>center</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>TRUE</span>), <span class='fl'>0</span>)</div><div class='output co'>#&gt;              003  012  102 021D 021U 021C 111D 111U 030T 030C 201 120D 120U
#&gt; max        16782 2472 1889   28   35   65   75   73    4    4  40    5    4
#&gt; perc.upper     1    0    0    0    0    0    1    0    0    0   0    1    1
#&gt; mean           0    0    0    0    0    0    0    0    0    0   0    0    0
#&gt; median         0    0    0    0    0    0    0    0    0    0   0    0    0
#&gt; perc.lower     0   -1    0    0    0    0    0   -1    0    0   0    0    0
#&gt; min        15573 1391 1048    5   10   19   30   24    0    0   6    0    0
#&gt; obs            0    0    0    0    0    0    0    0    0    0   0    0    0
#&gt; p&gt;             1    0    0    0    0    1    1    1    0    0   1    0    0
#&gt; p&gt;=            1    0    0    0    1    1    1    1    0    1   1    0    1
#&gt;            120C 210 300
#&gt; max           7  15  13
#&gt; perc.upper    1   1   1
#&gt; mean          0   0   0
#&gt; median        0   0   0
#&gt; perc.lower    0   0   0
#&gt; min           0   1   4
#&gt; obs           0   0   0
#&gt; p&gt;            0   0   0
#&gt; p&gt;=           0   0   1</div><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>### The mixed triad census for co-evolution of one-mode and two-mode networks:</span>
<span class='no'>actors</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaNodeSet.html'>sienaNodeSet</a></span>(<span class='fl'>50</span>, <span class='kw'>nodeSetName</span><span class='kw'>=</span><span class='st'>"actors"</span>)
<span class='no'>activities</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaNodeSet.html'>sienaNodeSet</a></span>(<span class='fl'>20</span>, <span class='kw'>nodeSetName</span><span class='kw'>=</span><span class='st'>"activities"</span>)
<span class='no'>onemodenet</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>s501</span>, <span class='no'>s502</span>), <span class='kw'>dim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>50</span>, <span class='fl'>2</span>)),
                            <span class='kw'>nodeSet</span><span class='kw'>=</span><span class='st'>"actors"</span>)
<span class='no'>twomodenet</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>s502</span>[<span class='fl'>1</span>:<span class='fl'>50</span>, <span class='fl'>1</span>:<span class='fl'>20</span>], <span class='no'>s503</span>[<span class='fl'>1</span>:<span class='fl'>50</span>, <span class='fl'>1</span>:<span class='fl'>20</span>]),
                                                        <span class='kw'>dim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>20</span>, <span class='fl'>2</span>)),
                            <span class='kw'>type</span><span class='kw'>=</span> <span class='st'>"bipartite"</span>, <span class='kw'>nodeSet</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"actors"</span>, <span class='st'>"activities"</span>))
<span class='no'>twodata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDataCreate.html'>sienaDataCreate</a></span>(<span class='no'>onemodenet</span>, <span class='no'>twomodenet</span>,
                        <span class='kw'>nodeSets</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>actors</span>, <span class='no'>activities</span>))
<span class='no'>twoeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getEffects.html'>getEffects</a></span>(<span class='no'>twodata</span>)
<span class='no'>twoeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>twoeff</span>, <span class='no'>outActIntn</span>, <span class='kw'>name</span><span class='kw'>=</span><span class='st'>"onemodenet"</span>,
                            <span class='kw'>interaction1</span><span class='kw'>=</span><span class='st'>"twomodenet"</span>)
<span class='no'>twoeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>twoeff</span>, <span class='no'>outActIntn</span>, <span class='kw'>name</span><span class='kw'>=</span><span class='st'>"twomodenet"</span>,
                            <span class='kw'>interaction1</span><span class='kw'>=</span><span class='st'>"onemodenet"</span>)
<span class='no'>twoeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>twoeff</span>, <span class='no'>from</span>, <span class='kw'>name</span><span class='kw'>=</span><span class='st'>"onemodenet"</span>,
                            <span class='kw'>interaction1</span><span class='kw'>=</span><span class='st'>"twomodenet"</span>)
<span class='no'>twoeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>twoeff</span>, <span class='no'>to</span>, <span class='kw'>name</span><span class='kw'>=</span><span class='st'>"twomodenet"</span>,
                            <span class='kw'>interaction1</span><span class='kw'>=</span><span class='st'>"onemodenet"</span>)
<span class='no'>twoeff</span>
<span class='co'># Shorter phases 2 and 3, just for example:</span>
<span class='no'>twoalgorithm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></span>(<span class='kw'>projname</span><span class='kw'>=</span><span class='st'>"twomode"</span>, <span class='kw'>nsub</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>n3</span><span class='kw'>=</span><span class='fl'>100</span>,
                                     <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>5634</span>)
(<span class='no'>ans</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='siena07.html'>siena07</a></span>(<span class='no'>twoalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>twodata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>twoeff</span>, <span class='kw'>returnDeps</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
   <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>))
(<span class='no'>gof.two</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans</span>, <span class='no'>mixedTriadCensus</span>,
                        <span class='kw'>varName</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"onemodenet"</span>, <span class='st'>"twomodenet"</span>), <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>))
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gof.two</span>, <span class='kw'>center</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
}

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>### Here come some useful functions for building your own auxiliary statistics:</span>
<span class='co'>### First an extraction function.</span>

<span class='co'># igraphNetworkExtraction extracts simulated and observed networks</span>
<span class='co'># from the results of a siena07 run.</span>
<span class='co'># It returns the network as an edge list of class "graph"</span>
<span class='co'># according to the igraph package.</span>
<span class='co'># Ties for ordered pairs with a missing value for wave=period or period+1</span>
<span class='co'># are zeroed;</span>
<span class='co'># note that this also is done in RSiena for calculation of target statistics.</span>
<span class='co'># However, changing structurally fixed values are not taken into account.</span>
<span class='no'>igraphNetworkExtraction</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>i</span>, <span class='no'>data</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>) {
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>igraph</span>)
  <span class='no'>dimsOfDepVar</span><span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span>(<span class='no'>data</span><span class='kw'>[[</span><span class='no'>groupName</span>]]$<span class='no'>depvars</span><span class='kw'>[[</span><span class='no'>varName</span>]], <span class='st'>"netdims"</span>)
  <span class='no'>missings</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>data</span><span class='kw'>[[</span><span class='no'>groupName</span>]]$<span class='no'>depvars</span><span class='kw'>[[</span><span class='no'>varName</span>]][,,<span class='no'>period</span>]) <span class='kw'>|</span>
    <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>data</span><span class='kw'>[[</span><span class='no'>groupName</span>]]$<span class='no'>depvars</span><span class='kw'>[[</span><span class='no'>varName</span>]][,,<span class='no'>period</span>+<span class='fl'>1</span>])
  <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span>(<span class='no'>i</span>)) {
    <span class='co'># sienaGOF wants the observation:</span>
    <span class='no'>original</span> <span class='kw'>&lt;-</span> <span class='no'>data</span><span class='kw'>[[</span><span class='no'>groupName</span>]]$<span class='no'>depvars</span><span class='kw'>[[</span><span class='no'>varName</span>]][,,<span class='no'>period</span>+<span class='fl'>1</span>]
    <span class='no'>original</span>[<span class='no'>missings</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
    <span class='no'>returnValue</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html'>graph.adjacency</a></span>(<span class='no'>original</span>)
  }
  <span class='kw'>else</span>
  {
    <span class='no'>missings</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_adjacency_matrix.html'>graph.adjacency</a></span>(<span class='no'>missings</span>)
    <span class='co'>#sienaGOF wants the i-th simulation:</span>
    <span class='no'>returnValue</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/difference.igraph.html'>graph.difference</a></span>(
      <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/make_empty_graph.html'>graph.empty</a></span>(<span class='no'>dimsOfDepVar</span>) +
        <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/edge.html'>edges</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>sims</span><span class='kw'>[[</span><span class='no'>i</span>]]<span class='kw'>[[</span><span class='no'>groupName</span>]]<span class='kw'>[[</span><span class='no'>varName</span>]]<span class='kw'>[[</span><span class='no'>period</span>]][,<span class='fl'>1</span>:<span class='fl'>2</span>])),
      <span class='no'>missings</span>)
  }
  <span class='no'>returnValue</span>
}

<span class='co'>### Then some auxiliary statistics.</span>

<span class='co'># GeodesicDistribution calculates the distribution of non-directed</span>
<span class='co'># geodesic distances; see ?sna::geodist</span>
<span class='co'># The default for \code{levls} reflects that geodesic distances larger than 5</span>
<span class='co'># do not differ appreciably with respect to interpretation.</span>
<span class='co'># Note that the levels of the result are named;</span>
<span class='co'># these names are used in the \code{plot} method.</span>
<span class='no'>GeodesicDistribution</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span> (<span class='no'>i</span>, <span class='no'>data</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>,
  <span class='no'>varName</span>, <span class='no'>levls</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>5</span>,<span class='fl'>Inf</span>), <span class='no'>cumulative</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='no'>...</span>) {
  <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>networkExtraction</span>(<span class='no'>i</span>, <span class='no'>data</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>)
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>network</span>)
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>sna</span>)
  <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sna</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sna/man/geodist.html'>geodist</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/sna/man/symmetrize.html'>symmetrize</a></span>(<span class='no'>x</span>))$<span class='no'>gdist</span>
  <span class='kw'>if</span> (<span class='no'>cumulative</span>)
  {
    <span class='no'>gdi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='no'>levls</span>, <span class='kw'>function</span>(<span class='no'>i</span>){ <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>a</span><span class='kw'>&lt;=</span><span class='no'>i</span>) })
  }
  <span class='kw'>else</span>
  {
    <span class='no'>gdi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='no'>levls</span>, <span class='kw'>function</span>(<span class='no'>i</span>){ <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>a</span><span class='kw'>==</span><span class='no'>i</span>) })
  }
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>gdi</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>levls</span>)
  <span class='no'>gdi</span>
}

<span class='co'># Holland and Leinhardt Triad Census from sna; see ?sna::triad.census.</span>
<span class='co'># For undirected networks, call this with levls=1:4</span>
<span class='no'>TriadCensus.sna</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>i</span>, <span class='no'>data</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>, <span class='no'>levls</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>16</span>){
  <span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>unloadNamespace</a></span>(<span class='st'>"igraph"</span>) <span class='co'># to avoid package clashes</span>
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>network</span>)
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>sna</span>)
  <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>networkExtraction</span>(<span class='no'>i</span>, <span class='no'>data</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>)
  <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/pkg/network/man/network.edgecount.html'>network.edgecount</a></span>(<span class='no'>x</span>) <span class='kw'>&lt;=</span> <span class='fl'>0</span>){<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sna/man/symmetrize.html'>symmetrize</a></span>(<span class='no'>x</span>)}
  <span class='co'># because else triad.census(x) will lead to an error</span>
  <span class='no'>tc</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sna</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sna/man/triad.census.html'>triad.census</a></span>(<span class='no'>x</span>)[<span class='no'>levls</span>]
  <span class='co'># names are transferred automatically</span>
  <span class='no'>tc</span>
}

<span class='co'># Holland and Leinhardt Triad Census from igraph; see ?igraph::triad_census.</span>
<span class='no'>TriadCensus.i</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>i</span>, <span class='no'>data</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>){
  <span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>unloadNamespace</a></span>(<span class='st'>"sna"</span>) <span class='co'># to avoid package clashes</span>
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>igraph</span>)
  <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>igraphNetworkExtraction</span>(<span class='no'>i</span>, <span class='no'>data</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>)
<span class='co'># suppressWarnings is used because else warnings will be generated</span>
<span class='co'># when a generated network happens to be symmetric.</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/warning.html'>suppressWarnings</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/igraph/man/triad_census.html'>triad_census</a></span>(<span class='no'>x</span>)),
            <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"003"</span>, <span class='st'>"012"</span>, <span class='st'>"102"</span>, <span class='st'>"021D"</span>,<span class='st'>"021U"</span>, <span class='st'>"021C"</span>, <span class='st'>"111D"</span>, <span class='st'>"111U"</span>,
            <span class='st'>"030T"</span>, <span class='st'>"030C"</span>, <span class='st'>"201"</span>,  <span class='st'>"120D"</span>, <span class='st'>"120U"</span>, <span class='st'>"120C"</span>, <span class='st'>"210"</span>, <span class='st'>"300"</span>))
}

<span class='co'># CliqueCensus calculates the distribution of the clique census</span>
<span class='co'># of the symmetrized network; see ?sna::clique.census.</span>
<span class='no'>CliqueCensus</span><span class='kw'>&lt;-</span><span class='kw'>function</span> (<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>, <span class='no'>levls</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>5</span>){
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>sna</span>)
  <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>networkExtraction</span>(<span class='no'>i</span>, <span class='no'>obsData</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>)
  <span class='no'>cc0</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sna</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sna/man/clique.census.html'>clique.census</a></span>(<span class='no'>x</span>, <span class='kw'>mode</span><span class='kw'>=</span><span class='st'>'graph'</span>, <span class='kw'>tabulate.by.vertex</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
    <span class='kw'>enumerate</span><span class='kw'>=</span><span class='fl'>FALSE</span>)<span class='kw'>[[</span><span class='fl'>1</span>]]
  <span class='no'>cc</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>*<span class='no'>levls</span>
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>cc</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>levls</span>)
  <span class='no'>levels.used</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>cc0</span>), <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>cc</span>)))
  <span class='no'>cc</span>[<span class='no'>levels.used</span>] <span class='kw'>&lt;-</span> <span class='no'>cc0</span>[<span class='no'>levels.used</span>]
  <span class='no'>cc</span>
}

<span class='co'># Distribution of Bonacich eigenvalue centrality; see ?igraph::evcent.</span>
<span class='no'>EigenvalueDistribution</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span> (<span class='no'>i</span>, <span class='no'>data</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>,
  <span class='no'>levls</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='fl'>0.125</span>)), <span class='no'>cumulative</span><span class='kw'>=</span><span class='fl'>TRUE</span>){
  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>igraph</span>)
  <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>igraphNetworkExtraction</span>(<span class='no'>i</span>, <span class='no'>data</span>, <span class='no'>sims</span>, <span class='no'>period</span>, <span class='no'>groupName</span>, <span class='no'>varName</span>)
  <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>igraph</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/eigen_centrality.html'>evcent</a></span>(<span class='no'>x</span>)$<span class='no'>vector</span>
  <span class='no'>a</span>[<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>a</span>)] <span class='kw'>&lt;-</span> <span class='fl'>Inf</span>
  <span class='no'>lel</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>levls</span>)
  <span class='kw'>if</span> (<span class='no'>cumulative</span>)
  {
    <span class='no'>cdi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='fl'>2</span>:<span class='no'>lel</span>, <span class='kw'>function</span>(<span class='no'>i</span>){<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>a</span><span class='kw'>&lt;=</span><span class='no'>levls</span>[<span class='no'>i</span>])})
  }
  <span class='kw'>else</span>
  {
    <span class='no'>cdi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='fl'>2</span>:<span class='no'>lel</span>, <span class='kw'>function</span>(<span class='no'>i</span>){
      <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>a</span><span class='kw'>&lt;=</span><span class='no'>levls</span>[<span class='no'>i</span>]) - <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>a</span> <span class='kw'>&lt;=</span> <span class='no'>levls</span>[<span class='no'>i</span>-<span class='fl'>1</span>])})
  }
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>cdi</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='no'>levls</span>[<span class='fl'>2</span>:<span class='no'>lel</span>])
  <span class='no'>cdi</span>
}

<span class='co'>## Finally some examples of the three auxiliary statistics constructed above.</span>
<span class='no'>mynet1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>s501</span>, <span class='no'>s502</span>, <span class='no'>s503</span>), <span class='kw'>dim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>50</span>, <span class='fl'>3</span>)))
<span class='no'>mybeh</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='no'>s50a</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"behavior"</span>)
<span class='no'>mydata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDataCreate.html'>sienaDataCreate</a></span>(<span class='no'>mynet1</span>, <span class='no'>mybeh</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getEffects.html'>getEffects</a></span>(<span class='no'>mydata</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>myeff</span>, <span class='no'>transTrip</span>, <span class='no'>cycle3</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>myeff</span>, <span class='no'>outdeg</span>, <span class='kw'>name</span><span class='kw'>=</span><span class='st'>"mybeh"</span>, <span class='kw'>interaction1</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>myeff</span>,  <span class='no'>outdeg</span>, <span class='kw'>name</span><span class='kw'>=</span><span class='st'>"mybeh"</span>, <span class='kw'>interaction1</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)
<span class='co'># Shorter phases 2 and 3, just for example:</span>
<span class='no'>myalgorithm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></span>(<span class='kw'>nsub</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>n3</span><span class='kw'>=</span><span class='fl'>200</span>, <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>765</span>, <span class='kw'>projname</span><span class='kw'>=</span><span class='kw'>NULL</span>)
(<span class='no'>ans2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='siena07.html'>siena07</a></span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>returnDeps</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
   <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>))
<span class='no'>gofc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans2</span>, <span class='no'>EigenvalueDistribution</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>,
  <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofc</span>)
<span class='fu'><a href='sienaGOF.html'>descriptives.sienaGOF</a></span>(<span class='no'>gofc</span>, <span class='kw'>showAll</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='no'>goftc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans2</span>, <span class='no'>TriadCensus</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>goftc</span>, <span class='kw'>center</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'># For this type of auxiliary statistics</span>
<span class='co'># it is advisable in the plot to center and scale.</span>
<span class='co'># note the keys at the x-axis; these names are given by sna::triad.census</span>
<span class='fu'><a href='sienaGOF.html'>descriptives.sienaGOF</a></span>(<span class='no'>goftc</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fu'><a href='sienaGOF.html'>descriptives.sienaGOF</a></span>(<span class='no'>goftc</span>))

<span class='no'>gofgd</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans2</span>, <span class='no'>GeodesicDistribution</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>,
  <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>cumulative</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofgd</span>)
<span class='co'># and without infinite distances:</span>
<span class='no'>gofgdd</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaGOF.html'>sienaGOF</a></span>(<span class='no'>ans2</span>, <span class='no'>GeodesicDistribution</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>,
  <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>levls</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>7</span>, <span class='kw'>cumulative</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofgdd</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tom Snijders, Christian Steglich, Johan Koskinen, Christoph Stadtfeld, James Hollway, Per Block, Nynke Niezink, Viviana Amati, Robert Krause.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


