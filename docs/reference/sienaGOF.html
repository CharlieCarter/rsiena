<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Functions to assess goodness of fit for SAOMs — sienaGOF • RSiena</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Functions to assess goodness of fit for SAOMs — sienaGOF" />
<meta property="og:description" content="The function sienaGOF assesses goodness of fit
 for a model specification as represented by an estimated
 sienaFit object created by siena07.
 This is done by simulations of auxiliary
 statistics, that differ from the statistics used for estimating
 the parameters. The auxiliary statistics must be given explicitly.
 The fit is good if the average values
 of the auxiliary statistics over many simulation runs are close
 to the values observed in the data.
 A Monte Carlo test based on the Mahalanobis
 distance is used to calculate frequentist \(p\)-values.
 Plotting functions can be used to diagnose bad fit. There are basic
 functions for calculating auxiliary statistics available out of the
 box, and the user is also permitted to create custom functions." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RSiena</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2-25</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">In the package</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/snlab-nl/rsiena">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functions to assess goodness of fit for SAOMs</h1>
    
    <div class="hidden name"><code>sienaGOF.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>sienaGOF</code> assesses goodness of fit
 for a model specification as represented by an estimated
 <code>sienaFit</code> object created by <code><a href='siena07.html'>siena07</a></code>.
 This is done by simulations of auxiliary
 statistics, that differ from the statistics used for estimating
 the parameters. The auxiliary statistics must be given explicitly.
 The fit is good if the average values
 of the auxiliary statistics over many simulation runs are close
 to the values observed in the data.
 A Monte Carlo test based on the Mahalanobis
 distance is used to calculate frequentist \(p\)-values.
 Plotting functions can be used to diagnose bad fit. There are basic
 functions for calculating auxiliary statistics available out of the
 box, and the user is also permitted to create custom functions.</p>
    </div>

    <pre class="usage"><span class='fu'>sienaGOF</span>(<span class='no'>sienaFitObject</span>, <span class='no'>auxiliaryFunction</span>,
        <span class='kw'>period</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>twoTailed</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
        <span class='kw'>cluster</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>robust</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>groupName</span><span class='kw'>=</span><span class='st'>"Data1"</span>,
        <span class='no'>varName</span>, <span class='no'>...</span>)
<span class='co'># S3 method for sienaGOF</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>center</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>violin</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>key</span><span class='kw'>=</span><span class='kw'>NULL</span>,
        <span class='kw'>perc</span><span class='kw'>=</span><span class='fl'>.05</span>, <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>fontsize</span><span class='kw'>=</span><span class='fl'>12</span>, <span class='no'>...</span>)
<span class='fu'>descriptives.sienaGOF</span>(<span class='no'>x</span>, <span class='kw'>center</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>perc</span><span class='kw'>=</span><span class='fl'>.05</span>, <span class='kw'>key</span><span class='kw'>=</span><span class='kw'>NULL</span>,
        <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>showAll</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sienaFitObject</th>
      <td><p>Results of class <code><a href='sienaFit.html'>sienaFit</a></code>, produced by a
    call to <code><a href='siena07.html'>siena07</a></code> with <code>returnDeps = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>auxiliaryFunction</th>
      <td><p>Function to be used to calculate
    the auxiliary statistics;
    this can be a user-defined function, e.g. depending on the <code>sna</code>
    or <code>igraph</code> packages.</p>
<p>See <code>Examples</code> and <code><a href='sienaGOF-auxiliary.html'>sienaGOF-auxiliary</a></code>
    for more information on the signature of this function.
    The basic signature is<br />
    <code>function(index, data, sims, period, groupName, varName, ...)</code>,
    where <code>index</code> is the index of the simulated network,
    or <code>NULL</code> if the observed variable is needed;
    <code>data</code> is the observed data object from which
    the relevant variables are extracted; <code>sims</code> is the list of simulations
    returned from <code>siena07</code>; <code>period</code> is the index of the period;
    and ... are further arguments (like <code>levls</code> in the examples below
    and in <code><a href='sienaGOF-auxiliary.html'>sienaGOF-auxiliary</a></code>).</p></td>
    </tr>
    <tr>
      <th>period</th>
      <td><p>Vector of period(s) to be used (may run from 1 to
    number of waves - 1). Has an effect only if <code>join=FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Whether to print intermediate results. This may give some
       peace of mind to the user because calculations can take some time.</p></td>
    </tr>
    <tr>
      <th>join</th>
      <td><p>Boolean: should sienaGOF do tests on all of the periods
       individually (<code>FALSE</code>), or sum across periods (<code>TRUE</code>)?</p></td>
    </tr>
    <tr>
      <th>twoTailed</th>
      <td><p>Whether to use two tails for calculating \(p\)-values on the
        Monte Carlo test. Recommended for advanced users only,
        as it is probably only applicable in rare cases.</p></td>
    </tr>
    <tr>
      <th>cluster</th>
      <td><p>Optionally, a <code>parallel</code> or <code>snow</code> cluster to execute
        the auxiliary function calculations on.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>Whether to use robust estimation of the covariance matrix.</p></td>
    </tr>
    <tr>
      <th>groupName</th>
      <td><p>Name of group; relevant for multi-group data sets.</p></td>
    </tr>
    <tr>
      <th>varName</th>
      <td><p>Name of dependent variable.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Result from a call to sienaGOF.</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>Whether to center the statistics by median during plotting.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>Whether to scale the statistics by range during plotting.
                scale=TRUE makes little sense without also center=TRUE.</p></td>
    </tr>
    <tr>
      <th>violin</th>
      <td><p>Use violin plots (vs. box plots only)?</p></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>Keys in the plot for the levels of the auxiliary statistic
        (as given by parameter <code>levls</code> in the examples).</p></td>
    </tr>
    <tr>
      <th>perc</th>
      <td><p>1 minus confidence level for the confidence bands (two sided).</p></td>
    </tr>
    <tr>
      <th>fontsize</th>
      <td><p>Font size for the observed values plotted.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments; for <code>sienaGOF()</code>, e.g., <code>levls</code> as a
       parameter for the auxiliary statistic in
       <code><a href='sienaGOF-auxiliary.html'>sienaGOF-auxiliary</a></code>;<br />
       for <code>plot.sienaGOF()</code>, e.g., the usual plotting parameters
       <code>main</code>, <code>xlab</code>, <code>ylab</code>, <code>cex</code>, <code>cex.main</code>,
       <code>cex.lab</code>, and <code>cex.axis</code>.</p></td>
    </tr>
    <tr>
      <th>showAll</th>
      <td><p>If FALSE, drops statistics with variance 0, like in the plot.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is used to assess the goodness of fit of an estimated stochastic
 actor-oriented model for an arbitrarily defined multidimensional auxiliary
 statistic. It operates basically by comparing the observed values, at the ends
 of the periods, with the simulated values for the ends of the periods.
 The differences are assessed by combining the components of the auxiliary
 statistic using the Mahalanobis distance.</p>
<p>The function does not work properly for data sets that include a
 <code><a href='sienaCompositionChange.html'>sienaCompositionChange</a></code> object. If you wish to test the
 fit for such a data set, you need (for the purpose of fit assessment only)
 to replace the data set by a data set where absent actors are represented
 by structural zeros, and estimate the same model for this data set with the
 corresponding effects object, and use <code>sienaGOF</code> for this
 <code><a href='sienaFit.html'>sienaFit</a></code> object.</p>
<p>To achieve comparability between simulated and observed dependent variables,
 variables that are missing in the data at the start or end of a period
 are replaced by 0 (for tie variables) or NA (for behavior variables).<br />
 If there are any differences between structural values at the beginning and
 at the end of a period, these are dealt with as follows.
 For tie variables that have a structural value at the start of the period,
 this value is used to replace the observed value at the end of the period
 (for the goodness of fit assessment only).
 For tie variables that have a structural value at the end of the period but a
 free value value at the start of the period, the reference value for the
 simulated values is lacking; therefore, the simulated values at the end of
 the period then are replaced by the structural value at the end of the period
 (again, for the goodness of fit assessment only).</p>
<p>The auxiliary statistics documented in <code><a href='sienaGOF-auxiliary.html'>sienaGOF-auxiliary</a></code>
 are calculated for the simulated dependent
 variables in Phase 3 of the estimation algorithm,
 returned in <code>sienaFitObject</code> because of having used
 <code>returnDeps = TRUE</code> in the call to <code><a href='siena07.html'>siena07</a></code>.
 These statistics should be chosen to represent features of the network
 that are not explicitly fit by the estimation procedure but can be
 considered important properties that the model at hand should represent well.
 Some examples are:</p><ul>
<li><p>Outdegree distribution</p></li>
<li><p>Indegree distribution</p></li>
<li><p>Distribution of the dependent behavior variable (if any).</p></li>
<li><p>Distribution of geodesic distances</p></li>
<li><p>Triad census</p></li>
<li><p>Edgewise homophily counts</p></li>
<li><p>Edgewise shared partner counts</p></li>
<li><p>Statistics depending on the combination of network
       and behavioral variables.</p></li>
</ul><p>The function is written so that the user can easily define other functions to
capture some other relevant aspects of the network, behaviors, etc.
This is further illustrated in the help page<br />
<code><a href='sienaGOF-auxiliary.html'>sienaGOF-auxiliary</a></code>.</p>
<p>We recommend the following heuristic approach to model checking:</p><ol>
<li><p>Check convergence of the estimation.</p></li>
<li><p>Assess goodness of fit (primarily using <code>join=TRUE</code>) on
  auxiliary statistics, and if necessary refine the model.</p></li>
<li><p>Assess time heterogeneity by <code><a href='sienaTimeTest.html'>sienaTimeTest</a></code>
   and if there is evidence for time heterogeneity
   either modify the base effects or include time dummy terms.</p></li>
</ol><p>No general rules can be given about whether time heterogeneity
 (<code><a href='sienaTimeTest.html'>sienaTimeTest</a></code>) or goodness of fit using <code>sienaGOF</code>
 have precedence. This is an explorative issue.</p>
<p>The <code>summary</code> function will display some useful information
 to help with model selection if some effects are set to FIX and
 TEST on the effects object. A rough estimator for the Mahalanobis
 distance that would be obtained at each proposed specification
 is given in the output. This can help guide model selection.
 This estimator is called the modified Mahalanobis distance (MMD).
 See Lospinoso (2012), the manual, or the references for more information.</p>
<p>The following functions are pre-fabricated for ease of use, and can
 be passed in as the <br />
 <code>auxiliaryFunction</code> with no extra effort;
 see <code><a href='sienaGOF-auxiliary.html'>sienaGOF-auxiliary</a></code> and the examples below.</p><ul>
<li><p><code><a href='sienaGOF-auxiliary.html'>IndegreeDistribution</a></code></p></li>
<li><p><code><a href='sienaGOF-auxiliary.html'>OutdegreeDistribution</a></code></p></li>
<li><p><code><a href='sienaGOF-auxiliary.html'>BehaviorDistribution</a></code></p></li>
<li><p><code><a href='sienaGOF-auxiliary.html'>TriadCensus</a></code></p></li>
<li><p><code><a href='sienaGOF-auxiliary.html'>mixedTriadCensus</a></code></p></li>
</ul>


    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>sienaGOF</code> returns a result of class <code>sienaGOF</code>;
    this is a list of elements of class <code>sienaGofTest</code>;
    if <code>join=TRUE</code>, the list has length 1; if <code>join=FALSE</code>,
    each list element corresponds to a period analyzed;
    the list elements are themselves lists again, including the
    following elements:</p>
<dt>- sienaFitName</dt><dd><p>The name of sienaFitObject.</p></dd>
    <dt>- auxiliaryStatisticName</dt><dd><p>The name of auxiliaryFunction.</p></dd>
    <dt>- Observations</dt><dd><p>The observed values for the auxiliary statistics.</p></dd>
    <dt>- Simulations</dt><dd><p>The simulated auxiliary statistics.</p></dd>
    <dt>- ObservedTestStat</dt><dd><p>The observed Mahalanobis distance in the data.</p></dd>
    <dt>- SimulatedTestStat</dt><dd><p>The Mahalanobis distance for the simulations.</p></dd>
    <dt>- TwoTailed</dt><dd><p>Whether the \(p\)-value corresponds to a one- or
                     two-tailed Monte Carlo test.</p></dd>
    <dt>- p</dt><dd><p>The \(p\)-value for the observed Mahalanobis distance in the
             permutation distribution of the
             simulated Mahalanobis distances.</p></dd>
    <dt>- Rank</dt><dd><p>Rank of the covariance matrix of the simulated auxiliary
              statistics.</p></dd>
    In addition there are several attributes which give, for model
    specifications with fixed-and-tested effects, approximations
    to the expected Mahalanobis distance for model specifications where
    each of these effects would be added. This is reported
    in the summary method. 
    The plot method makes violin plots or box plots, with superimposed
    confidence bands, for the simulated distributions of all elements
    of the auxiliaryFunction,
    with the observed values indicated by red dots;
    but statistics with variance 0 are dropped.

    descriptives.sienaGOF returns a matrix giving numerical
    information about what is plotted in the plot method:
    maximum, upper percentile, mean, median, lower percentile, minimum,
    of the simulated distributions of the auxiliary statistics, the
    observed values, and the proportions of simulated values greater
    and greater-or-equal than the observed values. 
    If center=TRUE the median is subtracted
    from mean, median, and percentiles; if scale=TRUE
    these numbers are divided by (maximum - minimum). 
    If showAll=FALSE, statistics with variance 0 will be dropped.

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>See <a href='http://www.stats.ox.ac.uk/~snijders/siena/'>http://www.stats.ox.ac.uk/~snijders/siena/</a>
  for general information on RSiena.</p></li>
<li><p>Lospinoso, J.A. and Snijders, T.A.B. (2019).
  Goodness of fit for stochastic actor-orientedmodels.
  <em>Methodological Innovations</em>, 12:2059799119884282.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='siena07.html'>siena07</a></code>, <code><a href='sienaGOF-auxiliary.html'>sienaGOF-auxiliary</a></code>,
         <code><a href='sienaTimeTest.html'>sienaTimeTest</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>mynet</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>s501</span>, <span class='no'>s502</span>), <span class='kw'>dim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>50</span>, <span class='fl'>2</span>)))
<span class='no'>mybeh</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='no'>s50a</span>[,<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"behavior"</span>)
<span class='no'>mydata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDataCreate.html'>sienaDataCreate</a></span>(<span class='no'>mynet</span>, <span class='no'>mybeh</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getEffects.html'>getEffects</a></span>(<span class='no'>mydata</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>myeff</span>, <span class='no'>transTrip</span>)</div><div class='output co'>#&gt;   effectName          include fix   test  initialValue parm
#&gt; 1 transitive triplets TRUE    FALSE FALSE          0   0   </div><div class='input'><span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='setEffect.html'>setEffect</a></span>(<span class='no'>myeff</span>, <span class='no'>cycle3</span>, <span class='kw'>fix</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>test</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;   effectName include fix  test initialValue parm
#&gt; 1 3-cycles   TRUE    TRUE TRUE          0   0   </div><div class='input'><span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='setEffect.html'>setEffect</a></span>(<span class='no'>myeff</span>, <span class='no'>transTies</span>, <span class='kw'>fix</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>test</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;   effectName      include fix  test initialValue parm
#&gt; 1 transitive ties TRUE    TRUE TRUE          0   0   </div><div class='input'><span class='no'>myalgorithm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></span>(<span class='kw'>nsub</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>n3</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>projname</span><span class='kw'>=</span><span class='kw'>NULL</span>)</div><div class='output co'>#&gt; If you use this algorithm object, siena07 will create an output file /var/folders/pl/ngry9kn13p7466xwk0_2xyh40000gn/T//RtmpB3MQ6s/Siena2a715dd2f15b.txt .
#&gt; This is a temporary file for this R session.</div><div class='input'><span class='co'># Shorter phases 2 and 3, just for example.</span>
<span class='no'>ans</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='siena07.html'>siena07</a></span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>returnDeps</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; 
#&gt; Start phase 0 
#&gt; theta:  4.696 -1.489  0.000  0.000  0.000  0.000  0.706  0.322  0.000 
#&gt; 
#&gt; Start phase 1 
#&gt; Phase 1 Iteration 1 Progress: 0%
#&gt; Phase 1 Iteration 2 Progress: 0%
#&gt; Phase 1 Iteration 3 Progress: 0%
#&gt; Phase 1 Iteration 4 Progress: 1%
#&gt; Phase 1 Iteration 5 Progress: 1%
#&gt; Phase 1 Iteration 10 Progress: 1%
#&gt; Phase 1 Iteration 15 Progress: 2%
#&gt; Phase 1 Iteration 20 Progress: 3%
#&gt; Phase 1 Iteration 25 Progress: 3%
#&gt; Phase 1 Iteration 30 Progress: 4%
#&gt; Phase 1 Iteration 35 Progress: 5%
#&gt; Phase 1 Iteration 40 Progress: 5%
#&gt; Phase 1 Iteration 45 Progress: 6%
#&gt; Phase 1 Iteration 50 Progress: 7%
#&gt; theta:  5.2799 -1.7720  0.6092  0.4717  0.0000  0.0000  0.7830  0.2090 -0.0422 
#&gt; 
#&gt; Start phase 2.1
#&gt; Phase 2 Subphase 1 Iteration 1 Progress: 67%
#&gt; Phase 2 Subphase 1 Iteration 2 Progress: 67%
#&gt; theta  5.3749 -1.9508  1.1122  0.6664  0.0000  0.0000  0.9440  0.1491 -0.0386 
#&gt; ac  1.0236  0.5498 -2.5738 -0.0824 -0.2741 -0.2132  2.1262  1.5114  0.9900 
#&gt; Phase 2 Subphase 1 Iteration 3 Progress: 67%
#&gt; Phase 2 Subphase 1 Iteration 4 Progress: 67%
#&gt; theta  5.30844 -2.12994  1.70842  0.63815  0.00000  0.00000  1.16872  0.04845 -0.00753 
#&gt; ac  0.428  0.314 -0.745 -0.190 -0.323 -0.392  1.649  0.897  0.537 
#&gt; Phase 2 Subphase 1 Iteration 5 Progress: 67%
#&gt; Phase 2 Subphase 1 Iteration 6 Progress: 67%
#&gt; theta  5.1668 -2.2629  2.0529  0.5923  0.0000  0.0000  1.1865  0.1190 -0.0351 
#&gt; ac  0.425  0.231 -0.694 -0.271 -0.394 -0.551  1.664  1.130  0.699 
#&gt; Phase 2 Subphase 1 Iteration 7 Progress: 68%
#&gt; Phase 2 Subphase 1 Iteration 8 Progress: 68%
#&gt; theta  5.2159 -2.3604  2.2393  0.5484  0.0000  0.0000  1.2002  0.1726 -0.0746 
#&gt; ac  0.444  0.156 -0.703 -0.304 -0.438 -0.649  1.658  1.120  0.689 
#&gt; Phase 2 Subphase 1 Iteration 9 Progress: 68%
#&gt; Phase 2 Subphase 1 Iteration 10 Progress: 68%
#&gt; theta  5.6306 -2.5512  2.3538  0.8007  0.0000  0.0000  1.2410  0.3054 -0.0708 
#&gt; ac  0.460  0.121 -0.622 -0.323 -0.459 -0.677  1.663  1.081  0.519 
#&gt; theta  5.7602 -2.4787  2.1751  0.5446  0.0000  0.0000  1.2352  0.3356 -0.0521 
#&gt; ac -0.06504 -0.45437 -0.48207 -0.30608 -0.30800 -0.69419  0.06487  0.12285 -0.00758 
#&gt; theta:  5.7602 -2.4787  2.1751  0.5446  0.0000  0.0000  1.2352  0.3356 -0.0521 
#&gt; 
#&gt; Start phase 3 </div><div class='input'><span class='no'>gofi</span> <span class='kw'>&lt;-</span> <span class='fu'>sienaGOF</span>(<span class='no'>ans</span>, <span class='no'>IndegreeDistribution</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
  <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet"</span>)</div><div class='output co'>#&gt; <span class='message'>Detected10iterations and1group.</span></div><div class='output co'>#&gt; Calculating auxiliary statistics for period  1 .</div><div class='output co'>#&gt; <span class='message'>  Period 1</span></div><div class='output co'>#&gt;   &gt; Completed  10  calculations
#&gt; </div><div class='output co'>#&gt; <span class='message'>Estimating test statistic for model including 3-cycles</span></div><div class='output co'>#&gt; <span class='message'>Estimating test statistic for model including transitive ties</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>gofi</span>)</div><div class='output co'>#&gt; Siena Goodness of Fit ( IndegreeDistribution ), all periods
#&gt; =====
#&gt; Monte Carlo Mahalanobis distance test p-value:  0 
#&gt; -----
#&gt; One tailed test used  (i.e. estimated probability of greater distance than observation).
#&gt; -----
#&gt; Calculated joint MHD = ( 2366.1 ) for current model.
#&gt; 
#&gt; One-step estimates and predicted Mahalanobis distances for modified models.
#&gt; 
#&gt; **Model including 3-cycles 
#&gt;                            one-step
#&gt; basic rate parameter mynet    4.576
#&gt; outdegree (density)          -2.555
#&gt; reciprocity                   1.586
#&gt; transitive triplets           0.498
#&gt; 3-cycles                      0.921
#&gt; transitive ties               0.000
#&gt; rate mybeh period 1           1.998
#&gt; mybeh linear shape           -0.101
#&gt; mybeh quadratic shape        -0.117
#&gt; MHD                        2301.730
#&gt; 
#&gt; **Model including transitive ties 
#&gt;                            one-step
#&gt; basic rate parameter mynet   13.578
#&gt; outdegree (density)          -3.044
#&gt; reciprocity                   6.485
#&gt; transitive triplets           2.225
#&gt; 3-cycles                      0.000
#&gt; transitive ties              -2.676
#&gt; rate mybeh period 1           2.216
#&gt; mybeh linear shape           -1.416
#&gt; mybeh quadratic shape        -1.558
#&gt; MHD                         224.108
#&gt; 
#&gt; -----
#&gt; Computation time for auxiliary statistic calculations on simulations:  0.012 seconds.</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofi</span>)</div><div class='img'><img src='sienaGOF-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Illustration just for showing a case with two dependent networks;</span>
<span class='co'># running time backwards is not meaningful!</span>
<span class='no'>mynet1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>s501</span>, <span class='no'>s502</span>), <span class='kw'>dim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>50</span>, <span class='fl'>2</span>)))
<span class='no'>mynet2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>s503</span>, <span class='no'>s501</span>), <span class='kw'>dim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>50</span>, <span class='fl'>2</span>)))
<span class='no'>mybeh</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDependent.html'>sienaDependent</a></span>(<span class='no'>s50a</span>[,<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"behavior"</span>)
<span class='no'>mydata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaDataCreate.html'>sienaDataCreate</a></span>(<span class='no'>mynet1</span>, <span class='no'>mynet2</span>, <span class='no'>mybeh</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getEffects.html'>getEffects</a></span>(<span class='no'>mydata</span>)
<span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>myeff</span>, <span class='no'>transTrip</span>)</div><div class='output co'>#&gt;   effectName                  include fix   test  initialValue parm
#&gt; 1 mynet1: transitive triplets TRUE    FALSE FALSE          0   0   </div><div class='input'><span class='no'>myeff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='includeEffects.html'>includeEffects</a></span>(<span class='no'>myeff</span>, <span class='no'>recip</span>, <span class='kw'>name</span><span class='kw'>=</span><span class='st'>"mynet2"</span>)</div><div class='output co'>#&gt;   effectName          include fix   test  initialValue parm
#&gt; 1 mynet2: reciprocity TRUE    FALSE FALSE          0   0   </div><div class='input'><span class='co'># Shorter phases 2 and 3, just for example.</span>
<span class='no'>ans</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='siena07.html'>siena07</a></span>(<span class='no'>myalgorithm</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>returnDeps</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; 
#&gt; Start phase 0 
#&gt; theta:  4.696 -1.489  0.000  0.000  5.430 -1.542  0.000  0.706  0.322  0.000 
#&gt; 
#&gt; Start phase 1 
#&gt; Phase 1 Iteration 1 Progress: 0%
#&gt; Phase 1 Iteration 2 Progress: 0%
#&gt; Phase 1 Iteration 3 Progress: 0%
#&gt; Phase 1 Iteration 4 Progress: 0%
#&gt; Phase 1 Iteration 5 Progress: 1%
#&gt; Phase 1 Iteration 10 Progress: 1%
#&gt; Phase 1 Iteration 15 Progress: 2%
#&gt; Phase 1 Iteration 20 Progress: 2%
#&gt; Phase 1 Iteration 25 Progress: 3%
#&gt; Phase 1 Iteration 30 Progress: 4%
#&gt; Phase 1 Iteration 35 Progress: 4%
#&gt; Phase 1 Iteration 40 Progress: 5%
#&gt; Phase 1 Iteration 45 Progress: 6%
#&gt; Phase 1 Iteration 50 Progress: 6%
#&gt; theta:  4.467 -1.646  0.118  0.186  5.990 -1.710  1.000  0.483  0.212  0.103 
#&gt; 
#&gt; Start phase 2.1
#&gt; Phase 2 Subphase 1 Iteration 1 Progress: 69%
#&gt; Phase 2 Subphase 1 Iteration 2 Progress: 69%
#&gt; theta  4.370 -1.795  0.337  0.471  6.318 -1.821  1.742  0.369  0.118  0.147 
#&gt; ac  2.071  0.687  1.282  1.593  1.828  0.372 30.841  0.858  0.935 -1.538 
#&gt; Phase 2 Subphase 1 Iteration 3 Progress: 69%
#&gt; Phase 2 Subphase 1 Iteration 4 Progress: 69%
#&gt; theta  4.4629 -1.9972  0.9636  0.6164  6.7872 -2.0616  2.6582  0.4390  0.0108  0.1402 
#&gt; ac  4.3860  3.6822  0.9243 -0.0204  0.9552  0.5603  0.5161  1.0038  0.9249  0.1596 
#&gt; Phase 2 Subphase 1 Iteration 5 Progress: 69%
#&gt; Phase 2 Subphase 1 Iteration 6 Progress: 69%
#&gt; theta  4.5818 -1.9865  1.3600  0.2251  6.7253 -2.1945  2.3935  0.8637  0.1996 -0.0943 
#&gt; ac  3.451  3.217  0.191 -2.854  0.866  0.590  0.515  0.950  1.034 -0.783 
#&gt; Phase 2 Subphase 1 Iteration 7 Progress: 69%
#&gt; Phase 2 Subphase 1 Iteration 8 Progress: 70%
#&gt; theta  4.745 -2.050  1.690  0.129  7.088 -2.291  2.566  1.105  0.287 -0.170 
#&gt; ac  0.3341  2.6722 -0.0687 -2.6516  0.5797  0.5919  0.5288  0.9412  1.0241 -0.6502 
#&gt; Phase 2 Subphase 1 Iteration 9 Progress: 70%
#&gt; Phase 2 Subphase 1 Iteration 10 Progress: 70%
#&gt; theta  5.114 -2.175  1.816  0.152  7.458 -2.378  2.733  1.211  0.345 -0.207 
#&gt; ac  0.427  1.947 -0.248 -2.187  0.571  0.603  0.553  0.946  0.964 -0.243 
#&gt; theta  5.7115 -2.4729  2.2186  0.4873  8.1438 -2.5050  2.8958  1.1958  0.3021 -0.0286 
#&gt; ac -0.1004 -0.4623 -0.4636 -0.2731 -0.0014  0.0529 -0.3701  0.1476 -0.2573 -0.2882 
#&gt; theta:  5.7115 -2.4729  2.2186  0.4873  8.1438 -2.5050  2.8958  1.1958  0.3021 -0.0286 
#&gt; 
#&gt; Start phase 3 </div><div class='input'><span class='no'>gofi</span> <span class='kw'>&lt;-</span> <span class='fu'>sienaGOF</span>(<span class='no'>ans</span>, <span class='no'>IndegreeDistribution</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>join</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
  <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)</div><div class='output co'>#&gt; <span class='message'>Detected10iterations and1group.</span></div><div class='output co'>#&gt; Calculating auxiliary statistics for period  1 .</div><div class='output co'>#&gt; <span class='message'>  Period 1</span></div><div class='output co'>#&gt;   &gt; Completed  10  calculations
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>gofi</span>)</div><div class='output co'>#&gt; Siena Goodness of Fit ( IndegreeDistribution ), all periods
#&gt; =====
#&gt; Monte Carlo Mahalanobis distance test p-value:  0.6 
#&gt; **Note: Only 8 statistics are necessary in the auxiliary function.
#&gt; -----
#&gt; One tailed test used  (i.e. estimated probability of greater distance than observation).
#&gt; -----
#&gt; Calculated joint MHD = ( 7.19 ) for current model.
#&gt; 
#&gt; Computation time for auxiliary statistic calculations on simulations:  0.013 seconds.</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofi</span>)</div><div class='output co'>#&gt; Note: some statistics are not plotted because their variance is 0.
#&gt; This holds for the statistic: 8.</div><div class='img'><img src='sienaGOF-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
(<span class='no'>gofi.nc</span> <span class='kw'>&lt;-</span> <span class='fu'>sienaGOF</span>(<span class='no'>ans</span>, <span class='no'>IndegreeDistribution</span>, <span class='kw'>cumulative</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
    <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>))
<span class='co'># cumulative is an example of "...".</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofi.nc</span>)
<span class='fu'>descriptives.sienaGOF</span>(<span class='no'>gofi.nc</span>)

(<span class='no'>gofi2</span> <span class='kw'>&lt;-</span> <span class='fu'>sienaGOF</span>(<span class='no'>ans</span>, <span class='no'>IndegreeDistribution</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet2"</span>))
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofi2</span>)

(<span class='no'>gofb</span> <span class='kw'>&lt;-</span> <span class='fu'>sienaGOF</span>(<span class='no'>ans</span>, <span class='no'>BehaviorDistribution</span>, <span class='kw'>varName</span> <span class='kw'>=</span> <span class='st'>"mybeh"</span>))
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofb</span>)

(<span class='no'>gofo</span> <span class='kw'>&lt;-</span> <span class='fu'>sienaGOF</span>(<span class='no'>ans</span>, <span class='no'>OutdegreeDistribution</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>,
    <span class='kw'>levls</span><span class='kw'>=</span><span class='fl'>0</span>:<span class='fl'>6</span>, <span class='kw'>cumulative</span><span class='kw'>=</span><span class='fl'>FALSE</span>))
<span class='co'># levls is another example of "...".</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>gofo</span>)
}

<span class='co'>## A demonstration of using multiple processes</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>parallel</span>)
(<span class='no'>n.clus</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span>() - <span class='fl'>1</span>) <span class='co'># subtract 1 to keep time for other processes</span>
<span class='no'>myalgorithm.c</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sienaAlgorithmCreate.html'>sienaAlgorithmCreate</a></span>(<span class='kw'>nsub</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>n3</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>1265</span>)
(<span class='no'>ans.c</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='siena07.html'>siena07</a></span>(<span class='no'>myalgorithm.c</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>mydata</span>, <span class='kw'>effects</span><span class='kw'>=</span><span class='no'>myeff</span>, <span class='kw'>batch</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
    <span class='kw'>returnDeps</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>useCluster</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>nbrNodes</span><span class='kw'>=</span><span class='no'>n.clus</span>))
<span class='no'>gofi.1</span> <span class='kw'>&lt;-</span> <span class='fu'>sienaGOF</span>(<span class='no'>ans.c</span>, <span class='no'>TriadCensus</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>)
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span>(<span class='no'>n.clus</span>)
<span class='no'>gofi.cl</span> <span class='kw'>&lt;-</span> <span class='fu'>sienaGOF</span>(<span class='no'>ans.c</span>, <span class='no'>TriadCensus</span>, <span class='kw'>varName</span><span class='kw'>=</span><span class='st'>"mynet1"</span>, <span class='kw'>cluster</span><span class='kw'>=</span><span class='no'>cl</span>)
<span class='co'># compare simulation times</span>
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span>(<span class='no'>gofi.1</span>,<span class='st'>"simTime"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span>(<span class='no'>gofi.cl</span>,<span class='st'>"simTime"</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Tom Snijders, Christian Steglich, Johan Koskinen, Christoph Stadtfeld, James Hollway, Per Block, Nynke Niezink, Viviana Amati, Robert Krause.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


